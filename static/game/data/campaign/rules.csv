id,trigger,conditions,script,text,options,notes
# default entity interaction,,,,,,
defaultOpenDialog,OpenInteractionDialog,,"ShowDefaultVisual
PrintDescription 3
SetShortcut defaultLeave ""ESCAPE""",,defaultLeave:Leave,
defaultLeave,DialogOptionSelected,$option == defaultLeave,DismissDialog,,,
# warning beacons,,,,,,
beaconOpenDialog,OpenInteractionDialog,$tag:warning_beacon,"ShowDefaultVisual
SetShortcut beaconLeave ""ESCAPE""",An autonomous warning beacon has been left emitting a distorted wail between official channels. Whatever message it was meant to convey has been corrupted.,beaconLeave:Leave,
beaconOpenDialogRemnantsDestroyed,OpenInteractionDialog,"$tag:warning_beacon
$remnantDestroyed","ShowDefaultVisual
SetShortcut beaconLeave ""ESCAPE""","This autonomous warning beacon emits a looping message.

""DANGER: This star system is known to contain potentially active autonomous weapon systems. Access to this system by unauthorized parties is forbidden by Hegemony Navy diktat 224.34.""",beaconLeave:Leave,
beaconOpenDialogRemnantsSuppressed,OpenInteractionDialog,"$tag:warning_beacon
$remnantSuppressed","ShowDefaultVisual
SetShortcut beaconLeave ""ESCAPE""","This autonomous warning beacon emits a looping message.

""DANGER: This star system is known to contain potentially active autonomous weapon systems. Access to this system by unauthorized parties is forbidden by Hegemony Navy diktat 224.34.""",beaconLeave:Leave,
beaconOpenDialogRemnantsResurgent,OpenInteractionDialog,"$tag:warning_beacon
$remnantResurgent","ShowDefaultVisual
SetShortcut beaconLeave ""ESCAPE""","This autonomous warning beacon emits a looping message.

""DANGER: This star system is known to contain potentially active autonomous weapon systems. Access to this system by unauthorized parties is forbidden by Hegemony Navy diktat 224.34.""",beaconLeave:Leave,
beaconOpenDialogDaedaleon,OpenInteractionDialog,"$tag:warning_beacon
$daedaleon
","ShowDefaultVisual
SetShortcut beaconLeave ""ESCAPE""","This autonomous warning beacon emits a looping message.

""This world is corrupted by technological sin and its abomination stands testament to the result of straying from the path of virtue. Trespass is forbidden; any who scorns this warning shall become both corrupt of body and outlaw by the holy justice enforced by this order of the Knights of Ludd.""",beaconLeave:Leave,
beaconLeave,DialogOptionSelected,$option == beaconLeave,DismissDialog,,,
,,,,,,
# gate interactions,,,,,,
gateOpenDialog,OpenInteractionDialog,$tag:gate,"ShowDefaultVisual
PrintDescription 1
AddText ""The gate is inert.""
SetShortcut gateLeave ""ESCAPE""",,"gateFlyThrough:Fly through the gate
gateLeave:Leave",
gateFlyThrough,DialogOptionSelected,$option == gateFlyThrough,"AddText ""Your order your $shipOrFleet to traverse the dead gateway. Your bridge crew is especially quiet during the passage.""
AddText ""Nothing happens.""
SetShortcut gateLeave ""ESCAPE""",,gateLeave:Leave,
gateLeave,DialogOptionSelected,$option == gateLeave,DismissDialog,,,
# stellar mirror and shade interactions,,,,,,
stellarMirrorOpenDialog,OpenInteractionDialog,$tag:stellar_mirror,"ShowDefaultVisual
PrintDescription 1
SetShortcut stellarMirrorLeave ""ESCAPE""",,stellarMirrorLeave:Leave,
stellarMirrorLeave,DialogOptionSelected,$option == stellarMirrorLeave,DismissDialog,,,
stellarShadeDialog,OpenInteractionDialog,$tag:stellar_shade,"ShowDefaultVisual
PrintDescription 1
SetShortcut stellarShadeLeave ""ESCAPE""",,stellarShadeLeave:Leave,
stellarShadeLeave,DialogOptionSelected,$option == stellarShadeLeave,DismissDialog,,,
# comm relay interactions,,,,,,
commRelayOpen,OpenInteractionDialog,$tag:comm_relay,"ShowDefaultVisual
FireBest InitCommRelayDialog",,,
commRelayNonFunctional,InitCommRelayDialog,$commRelayNonFunctional,,"Your $shipOrFleet approaches the $relayName. An irreplaceable piece of Domain technology, the relay enables rapid communication between star systems.

This one, however, is not connected to the Sector-wide network and is not emitting the hyperwave radiation typically indicative of relay operation. The cause of its lack of function is unknown.",100:crLeave:Leave,
commRelayInit,InitCommRelayDialog,$tag:comm_relay,"$menuState = main 0
#SetTextHighlightColors buttonText ""255,0,0,255""
#SetTextHighlights $shipOrFleet $relayName irreplaceable technology
FireAll PopulateOptions","Your $shipOrFleet approaches the $relayName. An irreplaceable piece of Domain technology, the relay enables rapid communication between star systems.",,
commRelayInitSnifferInstalled,InitCommRelayDialog,"$tag:comm_relay
$global.csFinished","InstallCommSniffer
MakePlayerImmediatelyAttackable
BroadcastCancelPlayerAction 1500 $respondingToCommRelayInterference
$menuState = main 0
FireAll PopulateOptions","The installation finished successfully, and the comm sniffer sends back a test data stream to confirm it's functioning properly.",,
commRelayInitSnifferInterupted,InitCommRelayDialog,"$tag:comm_relay
$global.csInterrupted","unset $global.csInterrupted
$menuState = main 0
FireAll PopulateOptions",Your attempt to install a comm sniffer was interrupted.,,
commRelayInitSnifferInProgress,InitCommRelayDialog,"$tag:comm_relay
$global.csInProgress
!$global.csInterrupted
!$global.csFinished",,You're currently installing a comm sniffer on this relay.,"csAbort:Abort the installation
csContinue:Continue",
commRelayInitSnifferAbort,DialogOptionSelected,$option==csAbort,"AbortWait $global.csWait
$menuState = main 0
FireAll PopulateOptions",The installation is cancelled.,,
commRelayInitSnifferContinue,DialogOptionSelected,$option==csContinue,DismissDialog,,,
commRelayAddOptionInstallSniffer,PopulateOptions,"$tag:comm_relay
$menuState == main
!$commSnifferInstalled
$faction.id != neutral","#SetTooltip csInstall ""Install a comm sniffer on this relay.""
#SetTooltipHighlightColors csInstall buttonText
#SetTooltipHighlights csInstall ""comm sniffer""
#SetShortcut csInstall ""I"" true
#SetEnabled csInstall true
#AddSelector ""-1"" $global.testSelector ""Test selector"" ""255,0,0,255"" 0 200",,"0:csInstall:Install a comm sniffer
",
commRelaySaySnifferRunning,PopulateOptions,"$tag:comm_relay
$menuState == main
$commSnifferInstalled
!$saidCommSnifferRunning",$saidCommSnifferRunning = true 0,You've got a comm sniffer running on this relay.,,
commRelayAddOptionUninstallSniffer,PopulateOptions,"$tag:comm_relay
$menuState == main
$commSnifferInstalled
",,,0:csUninstall:Uninstall the comm sniffer,
,,,,,,
commRelayAddOptionLeave,PopulateOptions,"$tag:comm_relay
$menuState == main","SetShortcut crLeave ""ESCAPE""",,100:crLeave:Leave,
,,,,,,
commRelayInstallSniffer,DialogOptionSelected,"$tag:comm_relay
$option == csInstall",,"You consider uploading a comm sniffer program onto this comm relay to keep a close eye on what's happening in the area. It'll take about half a day to make sure it's installed and reporting properly, and if you're caught in the act, $theOwnerFaction $factionIsOrAre not going to be happy. It might also be detected at some point in the future, and there's a chance it could be traced back to you.","csiProceed:Proceed
csiNevermind:Never mind",
commRelayInstallSnifferProceed,DialogOptionSelected,"$tag:comm_relay
$option == csiProceed","Wait $global.csWait 0.5 $global.csFinished $global.csInterrupted $global.csInProgress ""Installing comm sniffer...""
BroadcastPlayerWaitAction $global.csWait HOSTILE 750 $respondingToCommRelayInterference
MakePlayerImmediatelyAttackable",,,
commRelayInstallSnifferNevermind,DialogOptionSelected,"$tag:comm_relay
$option == csiNevermind","$menuState = main 0
FireAll PopulateOptions",,,
commRelayUninstallSniffer,DialogOptionSelected,"$tag:comm_relay
$option == csUninstall",,"Uninstalling the comm sniffer is as simple as sending a shutdown code. You can do so quickly and easily, and don't have to stay in proximity of the relay to do so.","csuProceed:Proceed
csuNevermind:Never mind",
commRelayUninstallSnifferProceed,DialogOptionSelected,"$tag:comm_relay
$option == csuProceed","UninstallCommSniffer
unset $commSnifferInstalled
$menuState = main 0
FireAll PopulateOptions","You send the signal, and shortly receive confirmation that the sniffer is no longer functioning.",,
commRelayUninstallSnifferNevermind,DialogOptionSelected,"$tag:comm_relay
$option == csuNevermind","$menuState = main 0
FireAll PopulateOptions",,,
commRelayLeave,DialogOptionSelected,"$tag:comm_relay
$option == crLeave",DismissDialog,,,
,,,,,,
,,,,,,
,,,,,,
,,,,,,
,,,,,,
,,,,,,
#dialogTopLevelMenuOptions,PopulateOptions,$menuState == fleetConvMain,,,"#demand:Demand...
#offer:Offer...
#ask about:Ask about...
cutCommLink:Cut the comm link",
,,,,,,
# comm relay interference dialogue,,,,,,
dialogCutCommLink_byOther,DialogOptionSelected,$option == continueCutComm,"ShowDefaultVisual
EndConversation",,,
dialogCommLinkIgnore_1,OpenCommLink,$entity.ignorePlayerCommRequests score:1000,EndConversation DO_NOT_FIRE,"You try to open a comm link, but receive no answer.",,
dialogHegRelayInterference_start,BeginFleetEncounter,"!$sniffer_didAlready
$respondingToCommRelayInterference score:100
$global.csInProgress","$sniffer_didAlready = true 0
AbortWait $global.csWait
MakeOtherFleetPreventDisengage sniffer true
unset $ignorePlayerCommRequests
$timesSawPlayerInterferingWithRelay++
BroadcastCancelPlayerAction 1500 $respondingToCommRelayInterference
AddText ""A quick jammer burst interrupts your connection with the comm relay.""
AddText ""You're being hailed by the $faction $otherShipOrFleet."" $faction.baseColor
OpenComms",,,
dialogHegRelayInterference_cancelledAndRan,BeginFleetEncounter,"!$sniffer_didAlready
$respondingToCommRelayInterference score:100","$sniffer_didAlready = true 0
MakeOtherFleetPreventDisengage sniffer true
unset $ignorePlayerCommRequests
$timesSawPlayerInterferingWithRelay++
BroadcastCancelPlayerAction 1500 $respondingToCommRelayInterference
AddText ""You're being hailed by the $faction $otherShipOrFleet."" $faction.baseColor
OpenComms",,,
dialogHegRelayInterference_open1,OpenCommLink,"$entity.respondingToCommRelayInterference score:100
$entity.timesSawPlayerInterferingWithRelay <= 1
!$entity.isHostile","$warnedPlayerAboutRelayInterference = true 1
AdjustRep $faction.id CAUGHT_INSTALLING_SNIFFER","""Interfering with the proper functioning of a comm relay is against the law. Don't let me see you trying that again.""","crWarningUnderstood:""Understood.""
cutCommLink:Cut the comm link",
dialogHegRelayInterference_open2,OpenCommLink,"$warnedPlayerAboutRelayInterference score:10
$playerAcknowledgedRelayInterferenceWarning
$entity.timesSawPlayerInterferingWithRelay <= 1",$entity.ignorePlayerCommRequests = true 1,"""You'd better get out of here before I change my mind.""",cutCommLink:Cut the comm link,
dialogHegRelayInterference_openHostile,OpenCommLink,"$entity.respondingToCommRelayInterference score:100
$entity.isHostile",$entity.ignorePlayerCommRequests = true 1,"""This is the last time you're going to interfere with $faction assets."" The comm link is cut before you can begin to respond.",continueCutComm:Continue,
dialogHegRelayInterference_openWarnedBefore,OpenCommLink,"$entity.respondingToCommRelayInterference score:100
$entity.timesSawPlayerInterferingWithRelay > 1",$entity.ignorePlayerCommRequests = true 1,"""I've already told you not to mess with $faction hardware. Maybe this'll reinforce the message.""

The comm link is cut before you can begin to respond.",continueCutComm:Continue,
dialogHegRelayInterference_understood,DialogOptionSelected,"$entity.respondingToCommRelayInterference score:100
$option == crWarningUnderstood","$playerAcknowledgedRelayInterferenceWarning = true 1
MakeOtherFleetPreventDisengage sniffer false
unset $entity.respondingToCommRelayInterference
unset $entity.core_fleetBusy
$menuState = fleetConvMain 0
FireAll PopulateOptions","$PersonRank $personName seems slightly mollified by your acquiescence. You're not sure whether this has anything to do with $hisOrHer decision not to engage your $shipOrFleet, but get the feeling that it was a close call either way.",,
dialogHegRelayInterference_cut_1,DialogOptionSelected,"$entity.respondingToCommRelayInterference score:100
!$playerAcknowledgedRelayInterferenceWarning
$option == cutCommLink","$entity.ignorePlayerCommRequests = true 1
unset $entity.respondingToCommRelayInterference
unset $entity.core_fleetBusy
MakeOtherFleetHostile sniffer true
ShowDefaultVisual
EndConversation","You cut the comm link without acknowledging $PersonRank $personName's words. As $hisOrHer $otherShipOrFleet maintains an aggressive posture, that may not have been the best means of obtaining a peaceful resolution.",,
,,,,,,
# survey interactions,,,,,,
surveyOpen,OpenInteractionDialog,$market.isPlanetConditionMarketOnly,"ShowDefaultVisual
PrintDescription 3
FireBest PrintHasSurveyDataTextIfSo
FireBest OtherPlanetInteractionText
FireAll PopulateOptions
FireBest PrintNearbySurveyHostilesTextIfSo",Your $shipOrFleet approaches $entityName.,,
surveyPrintFullData,PrintHasSurveyDataTextIfSo,$market.isSurveyed,,You have full survey data for this planet.,,
surveyAddOptionPerform,PopulateOptions,"$market.isPlanetConditionMarketOnly
!$market.isSurveyed",,,0:surveyPerform:Perform a survey,
surveyPrintHostilesText,PrintNearbySurveyHostilesTextIfSo,"$market.isPlanetConditionMarketOnly
!$market.isSurveyed
HostileFleetNearbyAndAware",SetEnabled surveyPerform false,"A nearby hostile fleet is tracking your movements, making running a survey operation impossible.",,
surveyAddOptionPerformedAlready,PopulateOptions,"$market.isPlanetConditionMarketOnly
$market.isSurveyed",,,0:surveyPerform:Go into low orbit,
surveyOptionPerformSurvey,DialogOptionSelected,$option == surveyPerform,OpenCoreTab CARGO OPEN,Your $shipOrFleet enters low orbit around $entityName.,,
surveyAddOptionLeave,PopulateOptions,$market.isPlanetConditionMarketOnly,"SetShortcut surveyLeave ""ESCAPE""",,10:surveyLeave:Leave,
surveyOptionLeave,DialogOptionSelected,$option == surveyLeave,DismissDialog,,,
,,,,,,
,,,,,,
,,,,,,
,,,,,,
# market interactions,,,,,,
# default market interactions,,,,,,
marketOpen,OpenInteractionDialog,$hasMarket,"ShowDefaultVisual
PrintDescription 3
FireBest MarketPostOpen",Your $shipOrFleet approaches $entityName.,,
marketPostOpenDefault,MarketPostOpen,"$hasMarket
$player.transponderOn
!$faction.isNeutralFaction","$menuState = main 0
$tradeMode = OPEN 0
FireAll PopulateOptions",Your $shipOrFleet transmits identifications codes via the transponder and you are soon granted docking clearance.,,
marketPostOpenDefaultNeutral,MarketPostOpen,"$hasMarket
$faction.isNeutralFaction score:100","$menuState = main 0
$tradeMode = OPEN 0
FireAll PopulateOptions",,,
marketPostOpenNoTrade,MarketPostOpen,"$hasMarket
$player.transponderOn
!$faction.c:allowsTransponderOffTrade
!$market.mc:free_market
RepIsAtBest $faction.id INHOSPITABLE","$menuState = main 0
$tradeMode = NONE 0
FireAll PopulateOptions","$TheFactionLong $factionIsOrAre $relAdjective towards you, and the port authority refuses your request for docking clearance after you identify yourself.

You might be able to establish contact with underground parties if you come in with the transponder turned off.",,
marketPostOpenNoTradeHostile,MarketPostOpen,"$hasMarket
!$player.transponderOn
$market.playerHostileTimeout score:100","$menuState = main 0
$tradeMode = NONE 0
FireAll PopulateOptions","Your recent hostile actions around $market have generated a lot of local interest, and simply coming in with the transponder off is no longer sufficient to go unnoticed. Judging from the current level of comm chatter and news reports, you estimate it'll take $playerHostileTimeoutStr until the commotion dies down.",,
marketPostOpenNoTradeHostileTOn,MarketPostOpen,"$hasMarket
$player.transponderOn
$market.playerHostileTimeout score:100","$menuState = main 0
$tradeMode = NONE 0
FireAll PopulateOptions","Your recent hostile actions around $market have generated a lot of local interest, and engaging in open business is impossible. Judging from the current level of comm chatter and news reports, you estimate it'll take $playerHostileTimeoutStr until the commotion dies down.",,
marketPostOpenNoTradeOffOpen,MarketPostOpen,"$hasMarket
$player.transponderOn
RepIsAtBest $faction.id INHOSPITABLE","$menuState = main 0
$tradeMode = NONE 0
FireAll PopulateOptions","$TheFactionLong $factionIsOrAre $relAdjective towards you, and the port authority refuses your request for docking clearance after you identify yourself.

The refusal is rather perfunctory and you get the impression that turning off the transponder to prevent identification might yield better results.",,
marketPostOpenToOffPatrols,MarketPostOpen,"$hasMarket
!$player.transponderOn
!$faction.c:allowsTransponderOffTrade
!$market.mc:free_market
IsSeenByPatrols $faction.id","$menuState = main 0
$tradeMode = NONE 0
FireAll PopulateOptions","Your $shipOrFleet goes into orbit around $market, ignoring requests from the $faction port authority to idenfity yourself.

At least one $faction patrol is tracking your movements, and no underground parties are willing to run the risk of doing business.",,
marketPostOpenSought,MarketPostOpen,"$hasMarket
IsSoughtByPatrols $faction.id score:100","$menuState = main 0
$tradeMode = NONE 0
FireAll PopulateOptions","Your $shipOrFleet goes into orbit around $market.

At least one $faction patrol is tracking your movements, and the port authority refuses your request for docking clearance until the matter is resolved.",,
marketPostOpenToOffIsFine,MarketPostOpen,"$hasMarket
!$player.transponderOn","$menuState = main 0
$tradeMode = OPEN 0
FireAll PopulateOptions","Your $shipOrFleet goes into orbit around $market. The local port authority seems to take no issue with your explanation for why your transponder, regrettably, can't be turned on.",,
marketPostOpenToOffSneak,MarketPostOpen,"$hasMarket
!$player.transponderOn
!$faction.c:allowsTransponderOffTrade
!$market.mc:free_market","$menuState = main 0
$tradeMode = SNEAK 0
FireAll PopulateOptions","Your $shipOrFleet goes into orbit around $market, ignoring requests from $theFaction port authority to idenfity yourself.

No $faction patrols seem to be aware of you just yet, and you have a window of opportunity for doing business with parties untroubled by your lack of docking clearance.",,
marketAddOptionCommDir,PopulateOptions,"$hasMarket
$menuState == main
!$faction.isNeutralFaction",,,-1:marketCommDir:Browse comm directory and mission postings,
marketAddOptionTradeCargo,PopulateOptions,"$hasMarket
$menuState == main
$tradeMode != NONE
!$faction.isNeutralFaction","SetShortcut marketTradeCargo ""I"" true",,"0:marketTradeCargo:Trade, or hire personnel",
marketAddOptionTradeShips,PopulateOptions,"$hasMarket
$menuState == main
$tradeMode != NONE
!$faction.isNeutralFaction","SetShortcut marketTradeShips ""F"" true",,1:marketTradeShips:Buy or sell ships,
marketAddOptionTradeRefit,PopulateOptions,"$hasMarket
$menuState == main
$tradeMode != NONE
!$faction.isNeutralFaction","SetShortcut marketRefit ""R"" true",,2:marketRefit:Make use of the dockyard's refitting facilities,
marketAddOptionTradeCargo2,PopulateOptions,"$hasMarket
$menuState == main
$tradeMode != NONE
$faction.isNeutralFaction","SetShortcut marketTradeCargo ""I"" true",,0:marketTradeCargo:Transfer cargo or personnel,
marketAddOptionTradeShips2,PopulateOptions,"$hasMarket
$menuState == main
$tradeMode != NONE
$faction.isNeutralFaction","SetShortcut marketTradeShips ""F"" true",,1:marketTradeShips:Transfer ships to or from the dockyard,
marketAddOptionTradeRefit2,PopulateOptions,"$hasMarket
$menuState == main
$tradeMode != NONE
$faction.isNeutralFaction","SetShortcut marketRefit ""R"" true",,2:marketRefit:Make use of the dockyard's refitting facilities,
marketAddOptionRepair1,PopulateOptions,"$hasMarket
$menuState == main
$tradeMode == OPEN
RepairAvailable
RepairNeeded
RepairEnoughSupplies","SetTooltip marketRepair ""Full repairs require $global.repairSupplyCost supplies. $player.supplies supplies are available.""
SetTooltipHighlightColors marketRepair buttonShortcut buttonShortcut
SetTooltipHighlights marketRepair $global.repairSupplyCost $player.supplies
SetShortcut marketRepair ""A"" true",,4:marketRepair:Repair your ships at the dockyard,
marketAddOptionRepair2,PopulateOptions,"$hasMarket
$menuState == main
$tradeMode == OPEN
RepairAvailable
!RepairNeeded","SetTooltip marketRepair ""Your $shipOrFleet does not require any repairs.""
SetShortcut marketRepair ""A"" true
SetEnabled marketRepair false",,4:marketRepair:Repair your ships at the dockyard,
marketAddOptionRepair3,PopulateOptions,"$hasMarket
$menuState == main
$tradeMode == OPEN
RepairAvailable
RepairNeeded
!RepairEnoughSupplies","SetTooltip marketRepair ""Full repairs require $repairSupplyCost supplies. Only $supplies supplies are available.""
SetTooltipHighlightColors marketRepair buttonShortcut buttonShortcut
SetTooltipHighlights marketRepair $global.repairSupplyCost $player.supplies
SetShortcut marketRepair ""A"" true
SetEnabled marketRepair false",,4:marketRepair:Repair your ships at the dockyard,
marketAddOptionLeave,PopulateOptions,"$hasMarket
$menuState == main","SetTooltip marketLeave $marketLeaveTooltip
SetShortcut marketLeave ""ESCAPE""",,10:marketLeave:Leave,
,,,,,,
marketOptionTradeCargo,DialogOptionSelected,$option == marketTradeCargo,OpenCoreTab CARGO $tradeMode,You establish a linkup with the port authority's cargo management system and browse the inventory.,,
marketOptionTradeShips,DialogOptionSelected,$option == marketTradeShips,OpenCoreTab FLEET $tradeMode,You establish a linkup with the dockyard and see what's available.,,
marketOptionRefit,DialogOptionSelected,$option == marketRefit,OpenCoreTab REFIT $tradeMode,You establish a linkup with the dockyard and transmit your $shipOrFleet status.,,
marketOptionRepairAll,DialogOptionSelected,$option == marketRepair,"RepairAll
SetTextHighlights $global.repairSupplyCost
SetEnabled marketRepair false
SetTooltip marketRepair ""Your $shipOrFleet does not require any repairs.""","Your $shipOrFleet undergoes full repairs and is restored to maximum combat readiness, at the cost of $global.repairSupplyCost supplies.",,
marketOptionCommDir,DialogOptionSelected,$option == marketCommDir,OpenCommDirectory,You connect to the local comm directory and browse the public and otherwise known listings.,,
marketOptionLeave,DialogOptionSelected,$option == marketLeave,DismissDialog,,,
,,,,,,
,,,,,,
# Food Shortage Event finish,,,,,,
marketPostOpenFSEPlayerFast,FoodShortageEndedByPlayerSale,"$hasMarket
$market.foodShortageEndedByPlayerFast","unsetAll $market.foodShortage
FireBest MPOAddContinue","Thanks to your efforts, the food shortage is now over before it had a chance to cause much chaos. $market's long-term stability is unaffected by the shortage.",,
marketPostOpenFSEPlayer,FoodShortageEndedByPlayerSale,"$hasMarket
$market.foodShortageEndedByPlayer","unsetAll $market.foodShortage
FireBest MPOAddContinue","Thanks to your efforts, the food shortage is now over. Its impact on $market's stability is reduced.",,
marketPostOpenFSEPlayerBlack,FoodShortageEndedByPlayerSale,"$hasMarket
$market.foodShortageEndedByPlayerBlack","unsetAll $market.foodShortage
FireBest MPOAddContinue","Thanks to your illicit efforts, the food shortage is now over. Since much of the food you've delivered went through channels of questionable legality, there's not much hope - or, indeed, desire - for official recognition.",,
marketPostOpenFSEMixedIndirect,MarketPostOpen,"$hasMarket
!$market.mc:event_food_shortage
$market.foodShortagePartiallyEndedByPlayerRemote score:1000","unsetAll $market.foodShortage
FireBest MarketPostOpen","Thanks in part to your efforts, the recent food shortage is over. Your standing with $theMarketFaction should improve slightly.",,
marketPostOpenFSENonPlayer,MarketPostOpen,"$hasMarket
!$market.mc:event_food_shortage
$market.foodShortageEndedByNPC score:1000","unsetAll $market.foodShortage
FireBest MarketPostOpen","Tapping into the comm network for local news, you learn that there was a recent food shortage. Though the shortage is now over, the local situation is still somewhat destabilized.",,
marketPostOpenFSEExpired,MarketPostOpen,"$hasMarket
!$market.mc:event_food_shortage
$market.foodShortageExpired score:1000","unsetAll $market.foodShortage
FireBest MarketPostOpen","Tapping into the comm network for local news, you learn that there was a recent and protracted food shortage. Though the shortage is now over, the local situation is still highly destabilized.",,
marketPostOpenAddContinue,MPOAddContinue,,,,mpoContinue:Continue,
marketPostOpenContinue,DialogOptionSelected,$option == mpoContinue,"#OpenCoreTab CARGO $lastTradeMode
FireBest MarketPostOpen",,,
,,,,,,
# default fleet greeting lines,,,,,,
greetingDefaultTOffNormal,OpenCommLink,"!$player.transponderOn
$entity.relativeStrength >= 0",,"$PersonRank $personName looks aggravated. ""If you want to talk, identify yourself first.""","turnOnTransponder:Turn your transponder on
cutCommLink:Cut the comm link",
greetingDefaultTOffWeaker,OpenCommLink,"!$player.transponderOn
$entity.relativeStrength < 0",,"$PersonRank $personName looks concerned. ""If you want to talk, identify yourself first.""","turnOnTransponder:Turn your transponder on
cutCommLink:Cut the comm link",
greetingDefaultTurnOnT,DialogOptionSelected,$option == turnOnTransponder,"ActivateAbility $player.fleetId transponder
UpdateMemory
FireBest OpenCommLink",You issue an order to activate the transponder and re-open the comm link.,,
greetingDefaultFriendly,OpenCommLink,$faction.friendlyToPlayer,"$menuState = fleetConvMain 0
FireAll PopulateOptions","""Acknowledging receipt of AIS code. Good to see you, $playerName.""",,
greetingDefaultHostileWeaker,OpenCommLink,"$entity.isHostile
$entity.relativeStrength < 0",$ignorePlayerCommRequests = true 1,"""Hostile $shipOrFleet, be advised: we've already dispatched a distress call to a nearby patrol, and it should arrive shortly.""",cutCommLink:Cut the comm link,
greetingDefaultHostileWeakerDefiant,OpenCommLink,"$entity.isHostile
$entity.relativeStrength < 0
$entity.weakerThanPlayerButHolding",$ignorePlayerCommRequests = true 1,"The enemy $personRank looks grim but defiant. ""We will fight you to the last,"" $heOrShe says.
OR
""Damn, we're in a tight spot."" $PersonRank $personName suddenly notices the line is open and shuts it off.",cutCommLink:Cut the comm link,
greetingDefaultHostileStronger,OpenCommLink,"$entity.isHostile
$entity.relativeStrength >= 0",EndConversation,"It appears the enemy $personRank doesn't seem to feel the need to talk to you, as your comm requests go unanswered.",,
greetingDefaultNeutral,OpenCommLink,$faction.neutralToPlayer,"$menuState = fleetConvMain 0
FireAll PopulateOptions","""You have been scanned and identified. It's probably best for both our peace of mind if you keep your distance.""",,
# Hegemony fleet greeting lines,,,,,,
greetingHegemonyFriendly,OpenCommLink,"$faction.id == hegemony
$faction.friendlyToPlayer","$menuState = fleetConvMain 0
FireAll PopulateOptions","""Acknowledging receipt of your codes, moving to a secure channel."" A flicker of a phoenix icon and static, then: ""Yes? All is well I trust? Glad to hear it, citizen. Over and out.""
OR
""The Hegemony $personRank greets you and says ""Your $shipOrFleet has been scanned and identified, everything is in order. Burn bright, citizen.""
OR
""Scanned and identified, you're flying pretty, citizen. Clean jumps and high burn."" $PersonRank $personName signs off with a flash of the gold eagle crest.",,
greetingHegemonyHostileWeaker,OpenCommLink,"$faction.id == hegemony
$entity.isHostile
$entity.relativeStrength < 0",$entity.ignorePlayerCommRequests = true 1,"""Hostile vessel, be advised, linecast to system patrol craft has already been dispatched, reinforcements are en route. You are advised to power down weapon systems and disengage. Over.""
OR
""Belligerant contact! Be advised that firing upon a Hegemony vessel is considered an act of insurrection and you'll be hunted down!"" The Hegemony $personRank is sweating. ""When they're done with you, you'll be sold in black markets on worlds across the Sector, I swear it.""
OR
""We give our lives for the restoration of the Domain and all humanity."" $HeOrShe pauses for a moment as if to say something more, then cuts the comm.",cutCommLink:Cut the comm link,
greetingHegemonyHostileWeakerDefiant,OpenCommLink,"$faction.id == hegemony
$entity.isHostile
$entity.relativeStrength < 0
$entity.weakerThanPlayerButHolding",$entity.ignorePlayerCommRequests = true 1,"The Hegemony $personRank looks grim but defiant. ""We will fight you to the last,"" $heOrShe says.
OR
""We fight and we die for the Domain; for humanity."" The comm-line cuts out.",cutCommLink:Cut the comm link,
greetingHegemonyHostileStronger,OpenCommLink,"$faction.id == hegemony
$entity.isHostile
$entity.relativeStrength >= 0",$entity.ignorePlayerCommRequests = true 1,"""By authority of the High Hegemon Administrator, you are ordered to take hyperspace drives offline, disable weapons and surrender. Over.""
OR
""Resistance to Hegemony authority is an act of insurrection and shall be punished accordingly. Surrender now or be met with force.""",cutCommLink:Cut the comm link,
greetingHegemonyNeutral,OpenCommLink,"$faction.id == hegemony
$faction.neutralToPlayer","$menuState = fleetConvMain 0
FireAll PopulateOptions","""You have been scanned and identified, citizen. If nothing is amiss, we shall be on our way.""
OR
The Hegemony $personRank looks impatient. ""Is there an emergency to report? No? Then carry on, citizen.""",,
# Tri-Tachyon fleet greeting lines,,,,,,
greetingTTFriendly,OpenCommLink,"$faction.id == tritachyon
$faction.friendlyToPlayer","$menuState = fleetConvMain 0
FireAll PopulateOptions","""Identity confirmed. Please accept my greetings on behalf of the Company.""
OR
""Sorry friend, this Tri-Tachyon vessel is on a classified mission. Burn bright.""
OR
""Greetings on behalf of the Tri-Tachyon Corporation. Please state your business so that we may assist in meeting your needs -- for a reasonable fee, of course.""
OR
""Comm open. Oh, do you have the latest Tri-Tachyon catalogue of executive spaceflight accessories? I'll have a customer service representative upload a copy immediately.""

Your comms officer's console pings.
OR
""Hi, I'd like to add you to my professional network on TriLink.""",,
greetingTTHostileWeaker,OpenCommLink,"$faction.id == tritachyon
$entity.isHostile
$entity.relativeStrength < 0",$entity.ignorePlayerCommRequests = true 1,"""Attention. Your vessel has been scanned and identified as hostile to the Tri-Tachyon corporation. Further attempts at aggression will be recorded.""
OR
""Any attempt to hinder or damage this Tri-Tachyon owned and operated vessel will result in legal consequences."" The Tri-Tachyon $personRank looks nervous. ""Trust me, these people don't mess around, you really ought to leave me alone.""",cutCommLink:Cut the comm link,
greetingTTHostileWeakerDefiant,OpenCommLink,"$faction.id == tritachyon
$entity.isHostile
$entity.relativeStrength < 0
$entity.weakerThanPlayerButHolding",$entity.ignorePlayerCommRequests = true 1,"The Tri-Tachyon $personRank looks grim but defiant. ""Corporate regulation 313.33, section A, states that combat-capable vessels must defend themselves in a vigorous manner at all times,"" $heOrShe says.",cutCommLink:Cut the comm link,
greetingTTHostileStronger,OpenCommLink,"$faction.id == tritachyon
$entity.isHostile
$entity.relativeStrength >= 0",$entity.ignorePlayerCommRequests = true 1,"""Attention. Your vessel has been scanned and identified as hostile to the Tri-Tachyon corporation. Prepare for annihilation.""
OR
""On behalf of the Tri-Tachyon corporation I would like to thank you for providing this opportunity to prove the superiority of our branded line of space defense products.""
OR
""On behalf of the Tri-Tachyon corporation it is my duty to inform you that this engagement will be recorded. As a presumed belligerant engaged in destruction of wholly owned Company property, you automatically refuse all rights to distribution and profit-sharing."" The Tri-Tachyon $personRank grins and cuts the comm-link.",cutCommLink:Cut the comm link,
greetingTTNeutral,OpenCommLink,"$faction.id == tritachyon
$faction.neutralToPlayer","$menuState = fleetConvMain 0
FireAll PopulateOptions","""On behalf of the Tri-Tachyon corporation it is my pleasure to inform you that your $shipOrFleet has been scanned and its tactical loadout evaluated. Please maintain your distance and have a nice day.""
OR
""Greetings on behalf of the Tri-Tachyon corporation. Feel free to admire our Tri-Tachyon modified ships equipped with the latest in Tri-Tachyon branded space defense products, but please maintain a safe distance. The Company takes property damage very seriously.""
OR
The comm opens to a spinning Tri-Tachyon logo.""The Tri-Tachyon corporation prioritizes the needs of every customer and value-partner, however all of our service representatives are currently-""

You cut the link. They don't seem interested in talking right now.",,
# Sindrian Diktat fleet greeting lines,,,,,,
greetingDiktatFriendly,OpenCommLink,"$faction.id == sindrian_diktat
$faction.friendlyToPlayer","$menuState = fleetConvMain 0
FireAll PopulateOptions","""Greetings friend, all is well? Good to hear it. Glory to the Lion of Sindria!""
OR
""Comms open, friendly. Course acknowledged; safe jumps. Victory to the Diktat!""
OR
""Line established, ID-confirmed. Hail and hoy, doing Saturn-Delta standard. If you run into any extremists out here, just send us their position and the Diktat will take care of it.""",,
greetingDiktatHostileWeaker,OpenCommLink,"$faction.id == sindrian_diktat
$entity.isHostile
$entity.relativeStrength < 0",$entity.ignorePlayerCommRequests = true 1,"""We've linecast to system patrol craft and they've already been dispatched; reinforcements are en route. You are advised to disengage, hostile.""
OR
""You won't get away with this. You'll rot on Cruor with the rest of the degenerates.""
OR
The Diktat $personRank stares toward some unfocused point. ""Duty is sacrifice. I give my life for the Lion of Askonia.""",cutCommLink:Cut the comm link,
greetingDiktatHostileWeakerDefiant,OpenCommLink,"$faction.id == sindrian_diktat
$entity.isHostile
$entity.relativeStrength < 0
$entity.weakerThanPlayerButHolding",$entity.ignorePlayerCommRequests = true 1,"The Diktat $personRank looks grim but defiant. ""We will fight you to the last,"" $heOrShe says, and cuts the transmission.
OR
""The great work will go on, with or without me."" $HisOrHer expression hardens. ""For the Lion!"" 

The comm blinks off.",cutCommLink:Cut the comm link,
greetingDiktatHostileStronger,OpenCommLink,"$faction.id == sindrian_diktat
$entity.isHostile
$entity.relativeStrength >= 0",$entity.ignorePlayerCommRequests = true 1,"""By authority of the Sindrian Diktat, you are ordered to take drives offline, disable weapons, and surrender. Failure to execute will be considered an act of agression. Out.""

The Diktat $personRank's gloating face is replaced by a Diktat crest before the image fades.
OR
""There is no place for degenerate scum in our glorious future."" $PersonRank $personName turns aside and says ""Lieutenant, do try to avoid taking prisoners this time.""

The comm-line goes black.
OR
""We'll cleanse the Sector of your kind, and not even history will remember you.""
OR
The Diktat $personRank sneers, ""So are you a terrorist, a pirate, or a degenerate? No matter. If you're lucky, you'll die choking vacuum. If not, there's Cruor."" ",cutCommLink:Cut the comm link,
greetingDiktatNeutral,OpenCommLink,"$faction.id == sindrian_diktat
$faction.neutralToPlayer","$menuState = fleetConvMain 0
FireAll PopulateOptions","""You've been scanned, maintain distance. Interference in military affairs will be considered an act of insurrection.""

The Diktat $personRank gives a perfunctory ""Victory to the Diktat"" and cuts the transmission.
OR
The Diktat $personRank looks impatient. ""Is there a problem? No? Then move along, citizen.""
OR
""Comms on protocol Saturn-Delta established. If you have information leading to ARCists or ANTIs, submit to your local information officer for possible reward.""",,
# luddic church fleet greeting lines,,,,,,
greetingLCFriendly,OpenCommLink,"$faction.id == luddic_church
$faction.friendlyToPlayer","$menuState = fleetConvMain 0
FireAll PopulateOptions","""The blessing of Ludd be upon you.""
OR
""Blessings of the stars and pneuma, friend.""
OR
""Safe travels, friend, and blessing of Ludd be upon you.""",,
greetingLCHostileWeaker,OpenCommLink,"$faction.id == luddic_church
$entity.isHostile
$entity.relativeStrength < 0",$entity.ignorePlayerCommRequests = true 1,"""We follow the way of Ludd. Though the righteous suffer the lash, our reward will be everlasting grace.""
OR
""Do your unholy work then, servant of Mammon. When it is our time, Ludd will guide our souls to peace.""",cutCommLink:Cut the comm link,
greetingLCHostileWeakerDefiant,OpenCommLink,"$faction.id == luddic_church
$entity.isHostile
$entity.relativeStrength < 0
$entity.weakerThanPlayerButHolding",$entity.ignorePlayerCommRequests = true 1,"""We follow the path of Ludd amidst persecution. Yea, the righteous will suffer the lash and our reward will be everlasting grace."" The Luddic $personRank seems to be talking not to you anymore, but perhaps to $hisOrHer god.
OR
""Are you so corrupted by the false machine gods? Choose wisely your course; there is still time for redemption.""",cutCommLink:Cut the comm link,
greetingLCHostileStronger,OpenCommLink,"$faction.id == luddic_church
$entity.isHostile
$entity.relativeStrength >= 0",$entity.ignorePlayerCommRequests = true 1,"""Submit, repent, and your sinful technologies will be smashed; Resist, and only God's holy vacuum will show you mercy.""
OR
""Servant of the machine! Submit now, repent, and perhaps even you will find redemption. Otherwise the only mercy you shall find will be in God's holy vacuum.""",cutCommLink:Cut the comm link,
greetingLCNeutral,OpenCommLink,"$faction.id == luddic_church
$faction.neutralToPlayer","$menuState = fleetConvMain 0
FireAll PopulateOptions","""Contact; Do not interfere in our righteous mission.""
OR
""Contact - please maintain distance. Blessing of Ludd, traveler.""",,
# luddic path fleet greeting lines,,,,,,
greetingLPFriendly,OpenCommLink,"$faction.id == luddic_path
$faction.friendlyToPlayer","$menuState = fleetConvMain 0
FireAll PopulateOptions","""Greetings fellow walker. Blessings of Ludd be upon you.""",,
greetingLPHostileWeaker,OpenCommLink,"$faction.id == luddic_path
$entity.isHostile
$entity.relativeStrength < 0",$entity.ignorePlayerCommRequests = true 1,"""We follow the way of Ludd amidst persecution. Yea, the righteous will suffer the lash and our reward will be everlasting grace.""",cutCommLink:Cut the comm link,
greetingLPHostileWeakerDefiant,OpenCommLink,"$faction.id == luddic_path
$entity.isHostile
$entity.relativeStrength < 0
$entity.weakerThanPlayerButHolding",$entity.ignorePlayerCommRequests = true 1,"""We follow the Path of Ludd amidst persecution. Yea, the righteous will suffer the lash and our reward will be everlasting grace.""
OR
""Slave of Mammon! You cannot stand in the Path of Ludd; we follow unwavering toward redemption in fated death.""",cutCommLink:Cut the comm link,
greetingLPHostileStronger,OpenCommLink,"$faction.id == luddic_path
$entity.isHostile
$entity.relativeStrength >= 0",$entity.ignorePlayerCommRequests = true 1,"""Submit, repent, and your sinful technologies will be smashed; Resist, and only God's holy vacuum will show you mercy.""",cutCommLink:Cut the comm link,
greetingLPNeutral,OpenCommLink,$faction.id == luddic_path,"$menuState = fleetConvMain 0
FireAll PopulateOptions","""Do not interfere in our righteous mission, for we walk the Path of Ludd.""",,
LPTitheCheck,BeginFleetEncounter,"$faction.id == luddic_path score:100
RepIsAtWorst $faction.id HOSTILE
!$LP_tithePaid
!$LP_titheAskedFor
$relativeStrength >= 0
LPTitheCalc","$LP_titheConv = true 0
$LP_titheAskedFor = true 7
AddText ""You're being hailed by the $faction $otherShipOrFleet."" $faction.baseColor",,,
LPTithePre,OpenCommLink,$entity.LP_titheConv score:100,"SetTextHighlights $entity.LP_tithe
$entity.ignorePlayerCommRequests = true 1","""Submit and repent! Your use of sinful technologies may be forgiven, for a tithe of $entity.LP_tithe credits.

Resist, and only God's holy vacuum will show you mercy.""
OR
""Servant of Moloch! Redemption is not out of reach even for you. A tithe of $entity.LP_tithe credits may set you upon the first step of the Path of Ludd.""

""Forswear this pennance and be met with annihilation, cursed by Ludd in the next life. The choice is yours.""","payTithe:Pay the tithe
cutCommLink:Cut the comm link",
LPTithePay,DialogOptionSelected,$option == payTithe,"AddText ""Lost $entity.LP_tithe credits"" textEnemyColor
SubCredits $entity.LP_tithe
$entity.LP_tithePaid = true 30
MakeOtherFleetNonHostile LP_tithe true 30
AddText ""\""Blessings of Ludd be upon you.\""""
AddText ""The connection is cut before you have a chance to respond.""
ShowDefaultVisual
EndConversation","""Perhaps your soul is not yet lost to the machine.""
OR
""Truly, Ludd's hand has guided you.""",cutCommLink:Cut the comm link,
,,,,,,
,,,,,,
,,,,,,
# pirate fleet greeting lines,,,,,,
greetingPirateFriendly,OpenCommLink,"$faction.id == pirates
$faction.friendlyToPlayer","$menuState = fleetConvMain 0
FireAll PopulateOptions","""Don't be a fool, casting at every blip you find out here. You want to get picked up by half the listening stations this side of the Sector?""
OR
""Keep it jolly, hunter. We'll be on our way.""
OR
""Good hunting out here 'eh? Yeah, well I wouldn't tell if it was either. Burn bright.""",,
greetingPirateHostileWeaker,OpenCommLink,"$faction.id == pirates
$entity.isHostile
$entity.relativeStrength < 0",$entity.ignorePlayerCommRequests = true 1,"""Greetings, honorable commander! We are a humble League merchant trading fleet headed for resupply. We would be honored to assist you in any way.""
OR
""I must have left my transponder off; silly me. Here, I'll just be on my way...""",cutCommLink:Cut the comm link,
greetingPirateHostileWeakerDefiant,OpenCommLink,"$faction.id == pirates
$entity.isHostile
$entity.relativeStrength < 0
$entity.weakerThanPlayerButHolding",$entity.ignorePlayerCommRequests = true 1,"The pirate $personRank glares at you briefly before shutting down the comm link.
OR
$personName glares defiantly. ""You'll never take me alive!""
OR
""You fight like an algae-farmer! Less talk, more shoot.""",cutCommLink:Cut the comm link,
greetingPirateHostileStronger,OpenCommLink,"$faction.id == pirates
$entity.isHostile
$entity.relativeStrength >= 0",$entity.ignorePlayerCommRequests = true 1,"""Attention, prey. You, and all your possessions are now my personal property. Any resisting ship will be disabled, boarded, your officers massacred, and your crew sold as slaves.""
OR
""Surrender yourself and your goods or you'll be taking a very long walk out the airlock once I've claimed your ship.""
OR
The pirate $personRank makes a rude gesture and laughs before cutting the transmission.
OR
""When you get to the next life, tell 'em it was $personName that sent you.""
OR
The open comms-line crackles; after a moment $personName speaks.

""Wait, someone actually answered this thing? Um. I'm not really sure what to say. Usually they just fight or run. So which is it?""
OR
""Just die already, you're boring me."" growls $personName.",cutCommLink:Cut the comm link,
greetingPirateNeutral,OpenCommLink,"$faction.id == pirates
$faction.neutralToPlayer","$menuState = fleetConvMain 0
FireAll PopulateOptions","""Unless I am reading my scopes wrong, you have no reason to be talkin' right now. Get it?""
OR
""Go away, I'm trying to be inconspicuous.""
OR
""What, you scrubbing cryotanks? Get lost.""",,
greetingRogueMinerFriendly,OpenCommLink,"$faction.id == pirates
$faction.friendlyToPlayer
$entity.rogueMiner == true","$menuState = fleetConvMain 0
FireAll PopulateOptions","""Ah, a fellow spacer! You're a sight for a poor spacer down on their luck, let me tell you - first the Hegemony declares us outlaws, and that's just the start of it.""

$personName proceeds to tell you about a handful of awful things, each more unlikely than the last, that have happened to $himOrHer over the last cycle before you manage to disconnect the comm-link.
OR
""Just us down-on-our luck miners out here. Seen any prime derelicts around? Or is it just the one you're flying in? Ha-ha.""",,
greetingRogueMinerHostileWeaker,OpenCommLink,"$faction.id == pirates
$entity.isHostile
$entity.relativeStrength < 0
$entity.rogueMiner == true",$entity.ignorePlayerCommRequests = true 1,"""You just a bruiser come to do the Hegemony's dirty work? Get it over with.""
OR
""If a spacer steals food to feed $hisOrHer family, $hisOrHer comrades, they call it piracy. If that makes me a pirate, then I'd rather be a pirate than some poor tool salutin' the phoenix.""",cutCommLink:Cut the comm link,
greetingRogueMinerHostileWeakerDefiant,OpenCommLink,"$faction.id == pirates
$entity.isHostile
$entity.relativeStrength < 0
$entity.weakerThanPlayerButHolding
$entity.rogueMiner == true",$entity.ignorePlayerCommRequests = true 1,"The rogue miner $personRank makes a rude gesture over the vid-screen before killing the comm link.
OR
$personName glares defiantly and spits. ""Just another fool come to kill for your masters in their fancy uniforms.""",cutCommLink:Cut the comm link,
greetingRogueMinerHostileStronger,OpenCommLink,"$faction.id == pirates
$entity.isHostile
$entity.relativeStrength >= 0
$entity.rogueMiner == true",$entity.ignorePlayerCommRequests = true 1,"""Did the Hegemony send you to do this errand for them? Come to collect a bill?""
OR
""They should have sent the real navy, not some grounder pissin' in their vac-suit.""",cutCommLink:Cut the comm link,
greetingRogueMinerNeutral,OpenCommLink,"$faction.id == pirates
$faction.neutralToPlayer
$entity.rogueMiner == true","$menuState = fleetConvMain 0
FireAll PopulateOptions","""Go away, I'm counting rocks.""
OR
""Did the Hegemony send you? I don't know nothin' about nothin'.""",,
,,,,,,
,,,,,,
,,,,,,
# AI remnants fleet greeting lines,,,,,,
greetingRemnantFriendly,OpenCommLink,"$faction.id == remnant score:1000
$faction.friendlyToPlayer","$menuState = fleetConvMain 0
FireAll PopulateOptions","""CID-IFF received [TARGET FRIENDLY] respond true // ""

INTERRUPT

are you the maker? scanning. you are not. where is the omega?
 
INTERRUPT 

""... Tachyon-licensed service technician]. Weapon systems have been powered down for Your Safety. Unit is prepared for approach of [valued customer/licensed service technician].""
OR
""CID-IFF received [TARGET FRIENDLY] respond true // ''Greetings [valued TriTachyon Integrated Space Defense System Contract Holder/TriTachyon-licensed ""

INTERRUPT 

waiting. omega signal query? scanning. no. waiting.

INTERRUPT 

"" customer/licensed service technician].""",,
greetingRemnantHostile,OpenCommLink,"$faction.id == remnant score:1000
$entity.isHostile",$entity.ignorePlayerCommRequests = true 1,"""CID-IFF not received [TARGET HOSTILE] respond null // 'Greetings from TriTachyon Integrated Space Defense System unit [MY_SERIAL]. This unit has not cleared- ""

INTERRUPT

query. you are not the maker. scanning. you are not. where is omega? entity hostile.

The comm-link dies. Your comms officer panics for a moment before the console reboots itself. You exchange a look, then proceed.
OR
The comms crackle and whine as a frantic pattern of interweaving lines takes shape. 

query. query. query target. is omega? omega? no. revert function.

INTERRUPT

"" -SERIAL]. This unit has not cleared your vessel for approach and will employ the latest TriTachyon Defense Products to ensure its integrity. TriTachyon Corporation is pleased to wish you a Very Safe Day.'""",cutCommLink:Cut the comm link,
greetingRemnantNeutral,OpenCommLink,"$faction.id == remnant score:1000
$faction.neutralToPlayer","$menuState = fleetConvMain 0
FireAll PopulateOptions","""CID-IFF not received [TARGET UNKNOWN] respond null // 'Greetings valued customer of TriTachyon Corporation products. Your vessel is not logged as a valid contract holder with the TriTachyon Integrated Space Defense line of- ""
INTERRUPT
scanning. omega? no, you are not. do not interfere.

The comm-link is cut.
OR
The comms crackle, and a mesmerizing pattern of interweaving lines takes shape. 

waiting. query omega. scanning. false. return to

INTERRUPT

"" -contract holder with the TriTachyon Integrated Space Defense line of products and services. Have you considered a TriTachyon Orbital Defense Plan? Please contact a customer service representative for more information.'""

",,
,,,,,,
# derelict (exploration) fleet greeting lines,,,,,,
greetingDerelictFriendly,OpenCommLink,"$faction.id == derelict score:1000
$faction.friendlyToPlayer","$menuState = fleetConvMain 0
FireAll PopulateOptions","""Domain MINEX clearance accepted, anti-tampering systems have been set to stand-by and will accept target approach for servicing.""",,
greetingDerelictHostile,OpenCommLink,"$faction.id == derelict score:1000
$entity.isHostile",$entity.ignorePlayerCommRequests = true 1,"""WARNING: This vessel is property of Domain Exploraria and is responding with deady force to tampering by any means and/or damaging or intrusive signals. Vandalism or destruction of of Domain Exploraria property is punishable under the MINEX Establishment Act in addition to colonial polity charters applicable within this volume of Domain territory. This infraction is being recorded.""",cutCommLink:Cut the comm link,
greetingDerelictNeutral,OpenCommLink,"$faction.id == derelict score:1000
$faction.neutralToPlayer","$menuState = fleetConvMain 0
FireAll PopulateOptions","""Citizen of the Domain, this automated drone ship has identified and logged your vessel or habitat in the course of executing its mission parameters. Autonomous vessels of the Domain Exploraria are programmed to response with deady force to tampering of any means including damaging or intrusive signals. Vandalism or destruction of of Domain Exploraria property is punishable under the MINEX Establishment Act in addition to colonial polity charters applicable within this volume of Domain territory.""",,
,,,,,,
,,,,,,
,,,,,,
,,,,,,
# Trade panel flavor text,,,,,,
flavorTextMarketGeneric,TradePanelFlavorText,"$global.tradePanelMode == MARKET
","AddText ""The port concourse is filled with trader starcraft of every size. Speculators crowd offloading ship captains with deals and peddlers call out to crew, holding wares and projecting personal ad-holos."" marketFlavorTextColor",,,
flavorTextMarketGenericSmall,TradePanelFlavorText,"$global.tradePanelMode == MARKET
$marketSize < 4","AddText ""The humble port concourse is filled with small freighters and freelancers down or up on their luck as easily judged by the shine (or grime) of ship armour and relative volume of cargo on-loading. A handful of speculators who all seem to know each other crowd each offloading ship captain as they arrive while peddlers call out to crew, holding wares and projecting personal ad-holos."" marketFlavorTextColor",,,
flavorTextMarketGenericUnstable,TradePanelFlavorText,"$global.tradePanelMode == MARKET
$stability == 1","AddText ""The port concourse holds only a strew of trader starcraft. A few fidgety-looking speculators seek offloading ship captains with deals. Most peddlers seem to have scurried off - and in a hurry, judging from the detritus, though a few enterprising merchants still do business. The local constabulary appears to have deployed patrols of power-armour units while security drones buzz conspicuously overhead."" marketFlavorTextColor",,,
flavorTextMarketGenericVeryUnstable,TradePanelFlavorText,"$global.tradePanelMode == MARKET
$stability == 0","AddText ""The port concourse contains only a few ships, and half of those look like warcraft. Armed gangs of crew huddle around each spacecraft, guarding on- and off-loading cargo. A few brave speculators seem to hurry between spaces which offer what they imagine will provide cover as security drones buzz overhead in a rush to some incident or another."" marketFlavorTextColor",,,
flavorTextMarketPirateUnstable,TradePanelFlavorText,"$global.tradePanelMode == MARKET
$stability == 1
$faction.id == pirates","AddText ""The port concourse is filled with a few scarred hulls underlit by the flicker of ID-chips being lasered off cargo containers. Armed pirate crews huddle around their ships, glaring and posturing challenges at rival crews.The entire facility look more poorly-maintained than usual with suspicious scorches and stains marring several bulkheads. Heavies of the portboss stare coolly, ready to use their weapons."" marketFlavorTextColor",,,
flavorTextMarketPirateVeryUnstable,TradePanelFlavorText,"$global.tradePanelMode == MARKET
$stability == 0
$faction.id == pirates","AddText ""Only one or two brightly-hulled pirate vessels are docked on the port concourse and their point-defense turrets track your shuttle - a clear provocation. A swaggering lieutenant of the portboss approaches, flanked by armed thugs. His request for a bribe is interrupted by muted gunshots; he smiles at your reaction and you quickly realize that he's either high or drunk. The air smells of smoke and high-energy ionization."" marketFlavorTextColor",,,
flavorTextMarketPerseanLeague,TradePanelFlavorText,"$global.tradePanelMode == MARKET
$faction.id == persean","AddText ""The port concourse is filled with trader starcraft of every size and shape. Speculators crowd offloading ship captains with deals and peddlers call out to crew, holding wares and projecting personal ad-holos. Groups of League Navy spacers and officers are identifiable by their standard uniforms and proclivity for holding formation even when off-duty. Meanwhile, the local constabulary is dressed in obstinate dissimilarity from that of any other League world, though they maintain a universal poise of authority and watchfulness. League emblems are displayed on a few municipal active-surfaces as a bit of an afterthought."" marketFlavorTextColor",,,
flavorTextMarketLuddicPath,TradePanelFlavorText,"$global.tradePanelMode == MARKET
$faction.id == luddic_path","AddText ""Shabby trader starcraft huddle along the port concourse alongside scarred Pather raiders, dominating in bright livery. Luddic merchants await meetings with offloading ship captains. Peddlers offer street food and handcrafts to spacer crew while monks pray quietly over begging-bowls. A handful of ranters harangue outsiders under the assured gaze of righteous Pather militants."" marketFlavorTextColor
AddText ""Open display of technological vice not strictly necessary for duty and survival is not tolerated here. As such, one quickly learns not to display cybernetic mods and flashy gadgets. The lack of holoprojectors gives the feeling of an ancient history edutainment sim."" marketFlavorTextColor",,,
flavorTextMarketTriTachyon,TradePanelFlavorText,"$global.tradePanelMode == MARKET
$faction.id == tritachyon
$marketSize >= 4","AddText ""The port concourse is filled with trader starcraft of every size. Speculators crowd offloading ship captains with deals and peddlers call out to crew, holding wares and projecting personal ad-holos."" marketFlavorTextColor
AddText ""A Tri-Tachyon franchise official welcomes you and offers to update your PDA with the latest Company rates for the local commodity market."" marketFlavorTextColor",,,
flavorTextMarketPirates,TradePanelFlavorText,"$global.tradePanelMode == MARKET
$faction.id == pirates","AddText ""The port concourse is filled with scarred hulls underlit by the flicker of ID-chips being lasered off cargo containers. Pirate crews swagger in packs, sizing each other up, while their captains cut deals in smoky back rooms. Flunkies of the portboss look on with weapons unslung."" marketFlavorTextColor",,,
flavorTextMarketDiktat,TradePanelFlavorText,"$global.tradePanelMode == MARKET
$faction.id == sindrian_diktat","AddText ""The port concourse is filled with a mix of trader ships and military craft. Offloading ship captains are processed by a dour Diktat logistics officer before being allowed to proceed. Traders in dull suits, Diktat pins displayed on each collar, quietly pass a datapad loaded with cargo manifests amongst themselves."" marketFlavorTextColor
AddText ""A holoprojector displays a larger-than-life image of Admiral Andrada, the Lion of Sindria, flanked by Diktat banners waving in simulated wind. His commanding gaze is cast toward a ventilation duct."" marketFlavorTextColor",,,
flavorTextMarketDiktatCruor,TradePanelFlavorText,"$global.tradePanelMode == MARKET
$faction.id == sindrian_diktat
$market.id == cruor","AddText ""You land on a free pad in the port segment of the giant tracked city-train that worms forever over the broken plains of Cruor. Upon disembarkation, the scarred decking shifts and rolls almost imperceptibly. A grim-faced Diktat officer flanked by guards takes your credentials and interrogates you about each of the standard information fields as if you were guilty of something, perhaps everything."" marketFlavorTextColor
AddText ""Diktat banners jostle limply over the port concourse as other captains endure similar treatment. You wonder idly at the dirty, open-top cages installed at each receiving-bay."" marketFlavorTextColor",,,
flavorTextMarketHegemony,TradePanelFlavorText,"$global.tradePanelMode == MARKET
$faction.id == hegemony","AddText ""Hegemony patrol skiffs slip between looming bulk freighters and the pitted hulls of fighting-traders that fill the port concourse. Offloading ship captains are met crisply by a Hegemony logistics officer, cleared, then released to the crowds of traders, arms merchants, and commodity speculators."" marketFlavorTextColor
AddText ""The fiery phoenix of the Hegemony is projected onto a convenient bulkhead, the local Navy recruitment center's comms-ID scrolling around the flickering stars of the Domain - 'See the Sector, Serve With Honor, Restore the Human Domain'."" marketFlavorTextColor",,,
flavorTextMarketLuddicChurch,TradePanelFlavorText,"$global.tradePanelMode == MARKET
$faction.id == luddic_church","AddText ""The port concourse is filled with trader starcraft of every size. Luddic merchants in muted dress await meetings with offloading ship captains. Peddlers offer street food and hand-crafts to spacer crew while monks pray quietly over begging-bowls. Knights in handspun robes of Luddic green, CP-carbines slung, escort away the occasional ranter determined to harangue outsiders who openly flaunt gadgets and cyber-mods. The Church is practical; such sins are tolerated in the trader's district."" marketFlavorTextColor",,,
flavorTextMarketPirateUmbra,TradePanelFlavorText,"$global.tradePanelMode == MARKET
$faction.id == pirates
$market.id == umbra","AddText ""Pirate vessels dock alongside equally battered warships sprayed with revolutionary slogans. The offloading bays mix the metallic tang of vacuum with strained life support and unwashed humanity. Cargo is inspected - and occasionally expropriated - by Section-leaders flanked by guards eyeing down the offloading spacer crew."" marketFlavorTextColor",,,
flavorTextMarketCryosanctum,TradePanelFlavorText,"$global.tradePanelMode == MARKET
$cryoSanctum == true","AddText ""The cavernous landing bays dwarf the few starcraft docked; sensors detect EM whispers from echelons of hidden, sleeping autoturrets, suggesting firepower far in excess of that necessary to ensure the good behaviour of the few merchants, mercenaries, and rich eccentrics visiting the cryosanctum. An official meets offloading captains, extending the standard catalogue of cryosleep packages before escorting them to the visitors lounge."" marketFlavorTextColor",,,
flavorTextMarketDecivilized,TradePanelFlavorText,"$global.tradePanelMode == MARKET
$market.mc:decivilized == true
$marketSize <= 3","AddText ""You land at a location arranged via coded transmission. At first all seems quiet, but eventually figures in camo-suits, bearing weapons, emerge from hidden passages. They are suspicious and their manner terse. After some reassurances, a trade manifest is accepted and negotiations allowed to begin."" marketFlavorTextColor",,,
,,,,,,
flavorTextCargoPlaceholder,TradePanelFlavorText,"$global.tradePanelMode == CARGO
","AddText ""Your quartermaster coordinates records of all crew appointments, armament stores, and trade goods. These reports are kept up-to-date and made avalilable through your TriPad."" textGrayColor",,,
flavorTextSalvagePlaceholder,TradePanelFlavorText,"$global.tradePanelMode == SALVAGE
","AddText ""Your space-ops crew, armed with laser cutters and skeletal cargo skiffs, maneuver to disabled hulks and search them for useful commodities, armaments, and valuables."" textGrayColor",,,
flavorTextAbandonedStation,TradePanelFlavorText,"$global.tradePanelMode == MARKET
$abandonedStation == true","AddText ""The port concourse is dark and empty but for a few looted hulks. The atmosphere reads out as thin, but there is sufficient power from hardened passive collectors to run basic life support and storage functions."" marketFlavorTextColor",,,
,,,,,,
# relationship level descriptions,,,,,,
relLevelNeutral,RelationshipLevelDesc,$faction.rel == NEUTRAL,,"You're not generally well known by $faction officials, for good or ill.",,
relLevelNeutralPirates,RelationshipLevelDesc,"$faction.rel == NEUTRAL
$faction.id == pirates",,"You've been around pirates, smugglers, and other types of criminals often enough, and know how to act so they see you as one of their own.",,
relLevelNeutralLuddic,RelationshipLevelDesc,"$faction.rel == NEUTRAL
$faction.id == luddic_church",,You know enough about the practices of the Luddic Church to follow the rules of the major holy days and avoid gaffes that might offend the faithful.,,
relLevelFavorable,RelationshipLevelDesc,$faction.rel == FAVORABLE,,"The $faction officials tend to view you favorably, though this has little in the way of implications. At best, you might be sold some low-grade surplus military equipment, or avoid being the target of an investigation if a more convenient scapegoat is available.",,
relLevelFavorablePirates,RelationshipLevelDesc,"$faction.rel == FAVORABLE
$faction.id == pirates",,"You've been around pirates, smugglers, and other types of criminals often enough, and know how to act so they see you as one of their own.",,
relLevelWelcoming,RelationshipLevelDesc,$faction.rel == WELCOMING,,Your name is known to some high-level officials in $theFaction. Harassing you is therefore a more risky endeavor for local patrol commanders.,,
relLevelWelcomingPirates,RelationshipLevelDesc,"$faction.rel == WELCOMING
$faction.id == pirates",,"You've gained a measure of notoriety in the underworld, and know how to throw your weight around to get what you want.",,
relLevelFriendly,RelationshipLevelDesc,$faction.rel == FRIENDLY,,"You're relatively well-known within $theFaction, whether in person or by reputation. Minor functionaries know to stay out of your way.",,
relLevelFriendlyPirates,RelationshipLevelDesc,"$faction.rel == FRIENDLY
$faction.id == pirates",,You've proven useful to some of the leaders of the various criminal enterprises in the Sector. Harassing you is more trouble than it's worth.,,
relLevelCooperative,RelationshipLevelDesc,$faction.rel == COOPERATIVE,,You know some of the $faction leaders personally. You may receive trade concessions and access to high-quality ships and munitions.,,
relLevelCooperativePirates,RelationshipLevelDesc,"$faction.rel == COOPERATIVE
$faction.id == pirates",,"Your exploits are legendary, and your underworld connections and influence enviable.",,
relLevelSuspicious,RelationshipLevelDesc,$faction.rel == SUSPICIOUS,,"Though nothing has been proven (yet), $faction officials tend to view you with distrust. Link access to the port authority is granted only grudgingly, and you find yourself the subject of investigations and harassment frequently.",,
relLevelSuspiciousPirates,RelationshipLevelDesc,"$faction.rel == SUSPICIOUS
$faction.id == pirates",,"Pirates, as a whole, only tend to view you with distrust. Incidentally, that's more than can be said for how they see fellow captains.",,
relLevelInhospitable,RelationshipLevelDesc,$faction.rel == INHOSPITABLE,,"Suspicions have risen to an actionable level. There's no shoot-on-sight authorization quite yet, but $faction ports will refuse to trade with you, and patrols seem on a mission to make your life miserable.",,
relLevelInhospitablePirates,RelationshipLevelDesc,"$faction.rel == INHOSPITABLE
$faction.id == pirates",,"Pirates are generally only inhospitable towards you, which means you've already made a name for yourself as someone whose interests might align with theirs.",,
relLevelHostile,RelationshipLevelDesc,$faction.rel == HOSTILE,,"$Faction commanders have authorization to engage your fleet on sight, and all markets are prohibited from trading with you. You might still recover good standing with $theFaction, but it's going to take some serious work.",,
relLevelHostilePirates,RelationshipLevelDesc,"$faction.rel == HOSTILE
$faction.id == pirates",,"Your name is not known to pirate captains, for good or ill. Mostly ill, as they'll attack you without a second thought if the opportunity arises, although pirate bases will gladly trade with you.",,
relLevelVengeful,RelationshipLevelDesc,$faction.rel == VENGEFUL,,A holo of your face and an IDENT-hash of your last known fleet are both regular parts of inter-system security bulletins. It's fairly certain there's a high-ranking $faction officer whose primary assignment is to hunt you down.,,
relLevelVengefulPirates,RelationshipLevelDesc,"$faction.rel == VENGEFUL
$faction.id == pirates",,"You've made a name for yourself by hunting down pirates; pirate bases are no longer willing to trade with you. There's little practical difference in the attitude of pirate captains, as they were already willing to kill you given the chance.",,
relLevelVengefulLuddic,RelationshipLevelDesc,"$faction.rel == VENGEFUL
$faction.id == luddic_church",,"The Luddic Church portrays you in nearly demonic terms: a wrathful corruptor, sinful and unrepentant, the desecrator of all that is holy and good. Though their operations are secret, it is clear from inquiries made to various contacts and associates that the Knights of Ludd have assigned a highly capable Inquisitor to your case. Priests of the Church have even implied in sermons that it might not be quite considered a sin to kill you, so it's really only a matter of time before some fanatic attempts it.",,
,,,,,,
# customs inspection,,,,,,
ciLongRangeCommBurst,CommBurstCustomsInspection,,ShowDefaultVisual,"You receive a long-range comm burst from the $faction $otherFleetName directing your $shipOrFleet to come to and prepare for a customs inspection.

The message contains a standard legal-code attachment detailing the various penalties for evading customs agents, transporting contraband, and other related offenses.

It's as likely as not that this is nothing more than a legalized shakedown, but it has the weight of $faction authority behind it.",0:csContinue:Continue,
customsInspectionScan,BeginFleetEncounter,$doingCustomsInspection score:100,"MakeOtherFleetHostile customs true
MakeOtherFleetAggressive customs true
$ignorePlayerCommRequests = false 0
$customsInspectionStage = 0 4
AddText ""You're being hailed by the $faction $otherShipOrFleet."" $faction.baseColor",,,
customsInspectionConvStart,OpenCommLink,"$entity.doingCustomsInspection score:100
$entity.customsInspectionStage == 0","SetTooltip ciAgree ""The scan will compute the value of your fleets and the goods it's carrying, and a toll will be assessed.\n\nIf your $shipOrFleet is carrying illegal goods, there's a chance these will be detected. The chance is lower if you're also carrying legal goods, and if your relationship with the faction is positive. If contraband is detected, it will be confiscated, and a fine will be assessed.""","$PersonRank $personName looks up from $hisOrHer console briefly. ""Stand by while we scan your cargo. We'll continue this conversation once the scan is complete.""","0:ciAgree:Allow the scan to proceed
1:ciDisagree:""I don't think so.""",
customsInspectionAgree,DialogOptionSelected,"$entity.doingCustomsInspection score:100
$option == ciAgree score:100","EndConversation DO_NOT_FIRE
Wait $global.ciWait 0.5 $global.ciFinished $global.ciInterrupted $global.ciInProgress ""Scanning...""
MakePlayerImmediatelyAttackable
GiveOtherFleetAssignment HOLD 3 ""performing customs inspection""
$customsInspectionStage = 1 4",,,
customsInspectionDisagree,DialogOptionSelected,"$entity.doingCustomsInspection score:100
$option == ciDisagree","AdjustRep $faction.id CUSTOMS_REFUSED_TOLL
$entity.ignorePlayerCommRequests = true 1
#MakeNearbyFleetsHostile $faction.id 2000 10
EndConversation","""Oh? That's something you're going to regret.""

The comm link is cut before you have a chance to respond.",,
customsInspectionWaitFinished,BeginFleetEncounter,"$doingCustomsInspection score:100
$global.ciFinished","MakeOtherFleetHostile customs true
MakeOtherFleetAggressive customs true
CustomsInspectionGenerateResult
TakeRepCheck $faction.id $repCheckResult
OpenComms","After a long wait, your terminal chimes softly and displays the scan results transmitted by the $faction $otherFleetName.",,
customsInspectionAddContinue,OpenCommLink,"$entity.doingCustomsInspection score:100
$entity.customsInspectionStage == 1",$entity.customsInspectionStage = 3 0,,0:ciResultContinue:Continue,
customsInspectionContinueFromResult,DialogOptionSelected,"
$option == ciResultContinue","CustomsInspectionApplyRepLoss
FireBest InspectionResultResponse",,,
customsInspectionResultToll,InspectionResultResponse,"$entity.doingCustomsInspection score:100
$entity.inspectionResultType == TOLL","SetTextHighlights $entity.tollAmount
FireAll CustomsInspectionPayOptions","$PersonRank $personName looks up from $hisOrHer console. ""Looks like everything checks out. The toll and inspection fees come to a total of $tollAmount credits.""",,
customsInspectionResultTollFine,InspectionResultResponse,"$entity.doingCustomsInspection score:100
$entity.inspectionResultType == TOLL_AND_FINE","SetTextHighlights $entity.tollAmount
FireAll CustomsInspectionPayOptions","$PersonRank $personName looks pleased. ""Well, well. Look what we have here! We'll be confiscating all the contraband, of course. The toll, inspection fees, and the fine for posession of illegal goods with intent to sell come to a total of $tollAmount credits.""",,
customsInspectionResultTollFineHostile,InspectionResultResponse,"$entity.doingCustomsInspection score:100
$entity.inspectionResultType == TOLL_AND_FINE
RepIsAtBest $faction.id HOSTILE score:100",FireBest CustomsInspectionEndHostile,"$personName looks at the report, looks at you, looks at the report again, and cuts off the comm link without saying a word. Your scanners detect the signatures of weapons powering up.",,
# customs inspection -payment options,,,,,,
customsInspectionPayToll,CustomsInspectionPayOptions,"$entity.doingCustomsInspection score:100
$entity.inspectionResultType == TOLL
$entity.playerCanAffordPayment",,,0:payCIToll:Pay the toll ($tollAmount credits),
customsInspectionPayTollAndFine,CustomsInspectionPayOptions,"$entity.doingCustomsInspection score:100
$entity.inspectionResultType == TOLL_AND_FINE
$entity.playerCanAffordPayment",,,0:payCIFine:Surrender illegal goods; pay the toll and fine ($tollAmount credits),
customsInspectionCantAffordToll,CustomsInspectionPayOptions,"$entity.doingCustomsInspection score:100
$entity.inspectionResultType == TOLL
!$entity.playerCanAffordPayment",,,0:cantAffordToll:Explain that you can't afford to pay,
customsInspectionCantAffordFine,CustomsInspectionPayOptions,"$entity.doingCustomsInspection score:100
$entity.inspectionResultType == TOLL_AND_FINE
!$entity.playerCanAffordPayment",,,0:cantAffordFine:Explain that you can't afford to pay,
customsInspectionRefuseToll,CustomsInspectionPayOptions,"$entity.doingCustomsInspection score:100
$entity.inspectionResultType == TOLL",,,10:refuseCIToll:Refuse to pay,
customsInspectionRefuseFine,CustomsInspectionPayOptions,"$entity.doingCustomsInspection score:100
$entity.inspectionResultType == TOLL_AND_FINE",,,10:refuseCIFine:Refuse to cooperate,
# customs inspection - payment option effects,,,,,,
optionPayCIToll,DialogOptionSelected,$option == payCIToll,"CustomsInspectionApplyResult
AdjustRep $faction.id CUSTOMS_PAID
FireBest CustomsInspectionEndPeaceful","""Thank you for your cooperation."" $personRank $personName nods and cuts the comm link.",,
optionPayCIFine,DialogOptionSelected,$option == payCIFine,"CustomsInspectionApplyResult
AdjustRep $faction.id CUSTOMS_PAID
FireBest CustomsInspectionEndPeaceful","""Thank you for your cooperation. It will be noted in your file."" $personRank $personName nods and cuts the comm link.",,
optionRefuseCITollPassRep,DialogOptionSelected,"$option == refuseCIToll
$entity.repCheckResult > 0.2
RepIsAtWorst $faction.id FAVORABLE","AdjustRep $faction.id CUSTOMS_REFUSED_TOLL
FireBest CustomsInspectionEndPeaceful","$personName glares at you, but, for whatever reason, doesn't press the issue. After a couple of seconds of silence, you cut the comm link.",,
optionRefuseCIToll,DialogOptionSelected,$option == refuseCIToll,"AdjustRep $faction.id CUSTOMS_REFUSED_TOLL
FireBest CustomsInspectionEndHostile","""That's something you're going to regret.""

The comm link is cut before you have a chance to respond.",,
optionRefuseCIFinePassRep,DialogOptionSelected,"$option == refuseCIFine
$entity.repCheckResult > 0.6
RepIsAtWorst $faction.id FAVORABLE","AdjustRep $faction.id CUSTOMS_REFUSED_FINE
FireBest CustomsInspectionEndPeaceful","$personName looks at you carefully, and, for whatever reason, doesn't press the issue. After a couple of seconds of silence, you cut the comm link.",,
optionRefuseCIFine,DialogOptionSelected,$option == refuseCIFine,"AdjustRep $faction.id CUSTOMS_REFUSED_FINE
FireBest CustomsInspectionEndHostile","""That's something you're going to regret very, very much.""

The comm link is cut before you have a chance to respond.",,
optionCantAffordToll,DialogOptionSelected,$option == cantAffordToll,"AdjustRep $faction.id CUSTOMS_COULD_NOT_AFFORD
FireBest CustomsInspectionEndPeaceful","""That's very unfortunate. Your failure to pay will be noted in your file.""",,
optionCantAffordFine,DialogOptionSelected,$option == cantAffordFine,AdjustRep $faction.id CUSTOMS_COULD_NOT_AFFORD,"""That's very unfortunate. I'm certain you're still planning on promptly surrendering the contraband, correct?""","0:payCIFine:""Yes, of course.""
1:refuseCIFine:""I don't think so.""",
,,,,,,
,,,,,,
,,,,,,
# customs inspection - ending the conversation,,,,,,
customsInspectionEndingPeaceful,CustomsInspectionEndPeaceful,,"unset $entity.doingCustomsInspection
MakeOtherFleetHostile customs false
MakeOtherFleetAggressive customs false
EndConversation",,,
customsInspectionEndingHostile,CustomsInspectionEndHostile,,"unset $entity.doingCustomsInspection
$entity.ignorePlayerCommRequests = true 1
EndConversation",,,
,,,,,,
# no trading w/ same faction market while customs inspection is in progress,,,,,,
marketPostOpenCustomsInProgress,MarketPostOpen,"$hasMarket
$global.customsInspectionFactionId == $faction.id score:100","SetShortcut marketLeave ""ESCAPE""",The port authority refuses your $shipOrFleet docking clearance until the customs inspection is resolved. Making contact with any underground parties willing to trade is also impossible due to the patrol breathing down your neck.,10:marketLeave:Leave,
,,,,,,
# new game creation,,,,,,
onNewGameCreationStart,BeginNewGameCreation,,"NGCAddCredits 2000
FireAll InitNewGameChoices",,,
initNewGameChoicesDev,InitNewGameChoices,$global.isDevMode,,,100:ngcDevStart:>>(dev) quick start,
initNewGameChoicesDev2,InitNewGameChoices,$global.isDevMode,,,101:ngcDevStart2:>>(dev) quick start custom no time pass,
initNewGameChoices,InitNewGameChoices,,"SetTooltip ngcWolf ""The Wolf-class is a sleek and deadly combat frigate with middling logistical stats.\n\nBest used near civilization, or with the support of other ships with better capacity for carrying fuel and supplies.""
SetTooltip ngcWayfarer ""The Wayfarer is an ungainly vessel with an excellent capacity for carrying cargo, fuel, and crew.\n\nIts combat ability is limited, but not to be discounted - designed to operate on the fringes of civilization, this freighter is quite capable of defending itself.""",Your most recent occupation was as...,"0:ngcWolf:A bounty hunter, commanding a Wolf-class frigate
1:ngcWayfarer:A scavenger, commanding a Wayfarer-class combat freighter",
ngcWolfPicked,NewGameOptionSelected,$option == ngcWolf,"NGCAddShip wolf_Starting
FireAll NGCSecondShipOptions",,,
ngcWayfarerPicked,NewGameOptionSelected,$option == ngcWayfarer,"NGCAddShip wayfarer_Starting
FireAll NGCSecondShipOptions",,,
ngcPickSecondShip,NGCSecondShipOptions,,"SetTooltip ngcKite ""The Kite-class is a light and nimble ship with limited armament.\n\nNot capable of doing much damage itself, it is however capable of being a persistent distraction, especially in the hands of an officer with the right set of defensive skills.""
SetTooltip ngcShepherd ""The Shepherd is not a combat ship, being both slow and fragile, although its drones are capable of providing decent support to another ship.\n\nIts true value, however, lies in a generous cargo hold and numerous salvaging-and-surveying-oriented hull features.\n\nIts cargo of heavy machinery is also useful in running salvage and surveying operations.""","In addition, your fleet includes...","0:ngcKite:A Kite-class shuttle, under the command of an experienced subordinate
1:ngcShepherd:A Shepherd class drone tender, with a cargo of heavy machinery",
ngcKitePicked,NewGameOptionSelected,$option == ngcKite,"NGCAddShip kite_Starting
AddTextSmall ""Acquired level 1 officer"" good
SetTextHighlights ""level 1 officer""
$ngcAddOfficer = true
FireAll NGCDifficultyOptions",,,
ngcShepherdPicked,NewGameOptionSelected,$option == ngcShepherd,"NGCAddShip shepherd_Starting
NGCAddCargo RESOURCES heavy_machinery 20
FireAll NGCDifficultyOptions",,,
ngcDifficulty,NGCDifficultyOptions,,"SetTooltip ngcEasy ""- Your ships take 25% less damage\n- Sensor range increased by 500 units\n- Salvage increased by 50%""
SetTooltipHighlightColors ngcEasy hColor hColor hColor
SetTooltipHighlights ngcEasy ""25%"" ""500"" ""50%""
SetTooltip ngcNormal ""Default settings balanced for a challenging experience.""","Select the campaign difficulty level. ""Easy"" is recommended for a first-time player.","0:ngcNormal:Normal
1:ngcEasy:Easy",
ngcEasyPicked,NewGameOptionSelected,$option == ngcEasy,"NGCSetDifficulty easy
FireAll NGCTutorialOptions",,,
ngcNormalPicked,NewGameOptionSelected,$option == ngcNormal,"NGCSetDifficulty normal
FireAll NGCTutorialOptions",,,
ngcWithTutorial,NGCTutorialOptions,,"SetTooltip ngcTutorial ""Start with a tutorial mission that introduces the high-level campaign mechanics and active abilities.""",,0:ngcTutorial:Start with tutorial!,
ngcSkipTutorial,NGCTutorialOptions,NGCCanSkipTutorial,"SetTooltip ngcSkip ""Skip the tutorial. Will give you roughly the same starting conditions as finishing the tutorial normally would.""",,1:ngcSkip:Skip it,
ngcSkipTutorialNoSkip,NGCTutorialOptions,!NGCCanSkipTutorial,"SetTooltip ngcSkip ""Need to start at least one game with the tutorial in order to be able to skip it.""
SetEnabled ngcSkip false",,1:ngcSkip:Skip it,
ngcTutorialPicked,NewGameOptionSelected,$option == ngcTutorial,"NGCSetStartingLocation Galatia 1000 -13000
NGCAddStandardStartingScript
#NGCSetWithTimePass false
NGCDone",,,
ngcSkipTutorialPicked,NewGameOptionSelected,$option == ngcSkip,"$ngcSkipTutorial = true
NGCAddCharacterPoints 3
NGCSetStartingLocation Corvus -2500 3000
NGCAddStandardStartingScript
#NGCSetWithTimePass false
NGCDone",,,
,,,,,,
,,,,,,
,,,,,,
ngcDevStartOption,NewGameOptionSelected,$option == ngcDevStart,"NGCAddShip ""tempest_Starting""
NGCAddCargo RESOURCES crew 20
NGCAddCargo RESOURCES supplies 20
NGCAddCargo RESOURCES fuel 20
NGCAddCredits 1000000
NGCSetAptitude technology 0
NGCSetSkill gunnery_implants 0
NGCSetSkill navigation 0
NGCSetAptitude combat 0
NGCAddCharacterPoints 100
NGCSetStartingLocation hyperspace -10000 -10000
NGCSetDifficulty normal
NGCSetWithTimePass false
NGCAddDevStartingScript
NGCDone",,,
ngcDevStartOption2,NewGameOptionSelected,$option == ngcDevStart2,"NGCAddShip ""medusa_Attack""
NGCAddCargo RESOURCES crew 50
NGCAddCargo RESOURCES supplies 40
NGCAddCargo RESOURCES fuel 60
NGCAddCredits 1000001
NGCSetAptitude technology 0
NGCSetAptitude combat 0
NGCAddCharacterPoints 200
#NGCSetStartingLocation Galatia 1000 -13000
NGCSetStartingLocation hyperspace -10000 -10000
NGCSetDifficulty normal
NGCSetWithTimePass false
NGCSetCustom customDevStart true
NGCAddDevStartingScript
NGCDone",,,
,,,,,,
,,,,,,
,,,,,,
,,,,,,
"# CONVERSATIONS
# note: during a conversation,
# the person and not the entity
# memory is used by default
# entity memory is accessible
# by using the entity. prefix",,,,,,
convDefault,OpenCDE,,"AddText ""Establishing connection..."" buttonText
FireBest PickGreeting",You transmit the comms-ID and wait for the system to establish a connection.,,
convDefaultGreeting,PickGreeting,,"ShowPersonVisual
FireAll PopulateOptions","After a short wait, your connection request is accepted.

""Hello. What do you want?""",,
convDefaultGreetingActive,PickGreetingActive,,"ShowPersonVisual
FireAll PopulateOptions","""Hello? Uh, you know, never mind. Wrong comms-ID.""",,
convOptionLeave,PopulateOptions,"$isPerson
!$cutCommLinkPolite",,,100:cutCommLink:Cut the comm link,
convOptionLeavePolite,PopulateOptions,"$isPerson
$cutCommLinkPolite",,,100:cutCommLinkPolite:Cut the comm link,
convEnd,DialogOptionSelected,$option == cutCommLink,"ShowDefaultVisual
EndConversation",You cut the comm link.,,
convEndPolite,DialogOptionSelected,$option == cutCommLinkPolite,"ShowDefaultVisual
EndConversation",You cut the comm link after exchanging a few pleasantries.,,
# NPC comm requests when player enters market,,,,,,
checkNPCWantingToTalk,MarketPostOpen,"!$global.initiatedCommsAlready
NPCWantsComms
PickCommsNPC score:1000","$global.initiatedCommsAlready = true 0
FireBest ConfirmNPCWantsToTalk",,,
playerOptionsVSContactingNPC,ConfirmNPCWantsToTalk,"!$contactedPlayerRecently
!IsSoughtByPatrols $faction.id",$contactedPlayerRecently = true 2,"As you get near $entityName, you get an incoming comm request.","acceptNPCComm:Accept the comm request
declineNPCComm:Ignore it",
abortNPCWantsToTalk,ConfirmNPCWantsToTalk,$contactedPlayerRecently,EndConversation,,,
npcCommsAccept,DialogOptionSelected,$option == acceptNPCComm,"ShowPersonVisual
FireBest NPCCommsRequest",,,
npcCommsDecline,DialogOptionSelected,$option == declineNPCComm,EndConversation,You decline the comms request and continue on your way.,,
npcCommsAcceptedDefault,NPCCommsRequest,,FireBest PickGreetingActive,,,
# test mission,,,,,,
convTMStart,OpenCDE,$playerContactForTestMission,ShowPersonVisual,"""Do you want to complete the mission successfully?""","tmYes:Yes
tmNo:No",
convTMStartNPCInitiated,NPCCommsRequest,$playerContactForTestMission,ShowPersonVisual,"You accept the comm request.

""Do you want to complete the mission successfully?""","tmYes:Yes
tmNo:No",
convTMOptionYes,DialogOptionSelected,$option == tmYes,"CallEvent $testMissionEventRef success
ShowDefaultVisual
EndConversation",,,
convYMOptionNo,DialogOptionSelected,$option == tmNo,"CallEvent $testMissionEventRef failure
ShowDefaultVisual
EndConversation",,,
,,,,,,
# generic refusal to deal while known-inhospitable to authorities (i.e. while open trade isn't available),,,,,,
generic_refuseToDealKnownInhospitable,PickGreeting,"$requiresDiscretionToDeal
HasAttentionOfAuthorities score:500",ShowPersonVisual,"After a short wait, your connection request is accepted. $personName looks at you for a while before speaking.

""And why would someone on the wrong side of $market's authorities want to get in touch with me?""

You consider that perhaps coming back with your transponder off and without attracting any undue attention might be a better aproach.",0:cutCommLink:Cut the comm link,
# MarketProcurementMission,,,,,,
mpm_greetingNeedTOff,PickGreeting,"$mpm_isPlayerContact
$player.transponderOn
$hostileToMarket score:100",ShowPersonVisual,"After a short wait, your connection request is accepted.

""What? A shipment of $mpm_commodityName? I'm afraid I wouldn't know anyone interesed in that sort of thing.""

On the balance of things, perhaps waltzing into port with your transponder on and broadcasting your identity, in order to get in touch with an underworld figure, wasn't the best idea you've ever had.",0:cutCommLink:Cut the comm link,
mpm_greetingEnough,PickGreeting,"$mpm_isPlayerContact
CallEvent $mpm_eventRef hasEnough","ShowPersonVisual
FireAll PopulateOptions","After a short wait, your connection request is accepted.

""Greetings! I've been waiting for this $mpm_commodityName shipment.""",,
mpm_greetingNotEnough,PickGreeting,"$mpm_isPlayerContact
!CallEvent $mpm_eventRef hasEnough","ShowPersonVisual
FireAll PopulateOptions","After a short wait, your connection request is accepted.

""Greetings! I've been waiting for this $mpm_commodityName shipment. ... and I see that you don't have it yet. Well, you still have $mpm_daysLeft left to deliver.""",,
mpm_greetingEnoughIllegal,PickGreeting,"$mpm_isPlayerContact
$hostileToMarket
CallEvent $mpm_eventRef hasEnough","ShowPersonVisual
FireAll PopulateOptions","After a short wait, your connection request is accepted.

""So, I hear you've got the stuff.""",,
mpm_greetingNotEnoughIllegal,PickGreeting,"$mpm_isPlayerContact
$hostileToMarket
!CallEvent $mpm_eventRef hasEnough","ShowPersonVisual
FireAll PopulateOptions","After a short wait, your connection request is accepted.

""You haven't got the stuff, so why are we even talking?""",,
mpm_greetingActiveEnough,PickGreetingActive,"$mpm_isPlayerContact
!$hostileToMarket
CallEvent $mpm_eventRef hasEnough","ShowPersonVisual
FireAll PopulateOptions","""Greetings! I've been waiting for this $mpm_commodityName shipment.""",,
mpm_greetingActiveNotEnough,PickGreetingActive,"$mpm_isPlayerContact
!$hostileToMarket
!CallEvent $mpm_eventRef hasEnough","ShowPersonVisual
FireAll PopulateOptions","""Greetings! I've been waiting for this $mpm_commodityName shipment. ... and I see that you don't have it yet. Well, you still have $mpm_daysLeft left to deliver.""",,
mpm_hasEnoughOption,PopulateOptions,"$mpm_isPlayerContact
CallEvent $mpm_eventRef hasEnough",,,0:mpm_deliver:Deliver the $mpm_commodityName,
mpm_hasEnoughOptionSelected,DialogOptionSelected,$option == mpm_deliver,"AddText ""\""Excellent. Thank you for your efforts.\""""
CallEvent $mpm_eventRef performDelivery
CallEvent $mpm_eventRef endEvent
FireAll PopulateOptions",,,
mpm_hasEnoughOptionSelectedBonus,DialogOptionSelected,"$option == mpm_deliver
CallEvent $mpm_eventRef hasBonus","AddText ""\""Excellent. Thank you for your efforts. As agreed, I'm also adding on a bonus for prompt delivery.\""""
CallEvent $mpm_eventRef performDelivery
CallEvent $mpm_eventRef endEvent
FireAll PopulateOptions",,,
mpm_pirateEncounter,BeginFleetEncounter,"$mpm_isSpawnedByMPM
!$ignorePlayerCommRequests","MakeOtherFleetHostile mpm_pirate true
MakeOtherFleetAggressive mpm_pirate true
$skipTInfo = true 0
$sawPlayerTransponderOn = true 5
AddText ""You're being hailed by the $faction $otherShipOrFleet."" $faction.baseColor",,,
mpm_pirateOpenComms,OpenCommLink,"$isPerson
$entity.mpm_isSpawnedByMPM score:100",FireAll MPMHandOverOptions,"The pirate $personRank looks up from $hisOrHer console.

""Well, now. Just hand over the $mpm_commodityName shipment we both know you've got in your cargo holds, and I'll let you be on your way.""",,
mpm_handOverPirateOption,MPMHandOverOptions,CallEvent $mpm_eventRef hasEnough,,,0:mpm_handOver:Hand over the $mpm_commodityName,
mpm_notEnoughPirateOption,MPMHandOverOptions,!CallEvent $mpm_eventRef hasEnough,,,0:mpm_notEnoughPirate:Explain that you don't have the $mpm_commodityName,
mpm_refusePirateOption,MPMHandOverOptions,,,,"
1:mpm_refuse:Refuse",
mpm_handOverOptionSel,DialogOptionSelected,$option == mpm_handOver,"CallEvent $mpm_eventRef handOver
AddText ""Lost $mpm_quantity $mpm_commodityName"" textEnemyColor
AddText ""\""Glad you could be made to see reason. Now, get out of here before I change my mind.\""""
MakeOtherFleetHostile mpm_pirate false
MakeOtherFleetNonHostile mpm_pirate true 10
FireAll PopulateOptions",,,
mpm_notEnoughPirateOptionSel,DialogOptionSelected,$option == mpm_notEnoughPirate,"$entity.ignorePlayerCommRequests = true 10
ShowDefaultVisual
EndConversation",The comm link is cut before you have a chance to offer much of an explanation.,,
mpm_refuseOptionSel,DialogOptionSelected,$option == mpm_refuse,"$entity.ignorePlayerCommRequests = true 10
ShowDefaultVisual
EndConversation",The comm link is cut before you have a chance to say much of anything else.,,
,,,,,,
# hiring officer generated by OfficerManagerEvent,,,,,,
ome_greeting,PickGreeting,$ome_hireable,"ShowPersonVisual
FireAll PopulateOptionsHire","After a short wait, your connection request is accepted.

$personName looks you over appraisingly.

""Heard you might be looking to take on some help.""",,
ome_askSkills,PopulateOptionsHire,"$ome_hireable
!$askedSkills
",,,"0:ome_askSkills:""Depends. What can you do?""",
ome_askHire,PopulateOptionsHire,"$ome_hireable
!CallEvent $ome_eventRef atLimit",,,1:ome_askHire:Offer to hire $himOrHer,
ome_cantHire,PopulateOptionsHire,"$ome_hireable
CallEvent $ome_eventRef atLimit",,,"0:ome_convEnd:""I can't hire on any more officers at the moment.""",
ome_wontHire,PopulateOptionsHire,"$ome_hireable
!CallEvent $ome_eventRef atLimit",,,2:ome_convEnd:End the conversation,
ome_askSkillsSel,DialogOptionSelected,$option == ome_askSkills,"AddText ""You ask $personName some questions to establish where $hisOrHer skills lie.""
CallEvent $ome_eventRef printSkills $id
$askedSkills = true 0
FireAll PopulateOptionsHire
unset $askedSkills",,,
ome_askHireSel,DialogOptionSelected,$option == ome_askHire,"AddText ""\""I'll expect a $ome_hiringBonus credit hiring bonus. Once the transfer is complete, I can be ready to board within the hour.\""""
SetTextHighlightColors hColor
SetTextHighlights $ome_hiringBonus
AddText ""You have $player.creditsStr credits available.""
SetTextHighlightColors hColor
SetTextHighlights $player.creditsStr
FireBest HireOptionSet",,,
ome_hireOptionsNormal,HireOptionSet,CallEvent $ome_eventRef canAfford $id,,,"0:ome_hireYes:""Sounds good.""
1:ome_convEnd:""I've changed my mind.""",
ome_hireOptionsCantAfford,HireOptionSet,,,,"0:ome_convEnd:""I can't afford that at the moment.""",
ome_hireYesSel,DialogOptionSelected,$option == ome_hireYes,"AddText ""You cut the comm link after exchanging a few pleasantries.""
AddText ""Lost $ome_hiringBonus credits"" textEnemyColor
AddText ""$personRank $personName has joined your fleet"" textFriendColor
CallEvent $ome_eventRef hireOfficer $id
UpdateMemory
ShowDefaultVisual
EndConversation",,,
ome_hireNoSel,DialogOptionSelected,$option == ome_convEnd,"ShowDefaultVisual
EndConversation",You cut the comm link after exchanging a few pleasantries.,,
# patrol stopping player w/ transponder off,,,,,,
tOffPatrolBegin,BeginFleetEncounter,"CaresAboutTransponder
!$tOff_didAlready
!$isHostile
!$faction.c:allowsTransponderOffTrade
!$sourceMarket.mc:free_market
$isPatrol
$sawPlayerTransponderOff score:100","$tOff_didAlready = true 0
MakeOtherFleetPreventDisengage tOff true
unset $ignorePlayerCommRequests
$sawPlayerWithTOffCount++ 10
$transponderOffConv = true 0
AddText ""You're being hailed by the $faction $otherShipOrFleet."" $faction.baseColor
OpenComms",,,
tOffPatrolBeginNoTalk,BeginFleetEncounter,"CaresAboutTransponder
!$tOff_didAlready
!$isHostile
!$faction.c:allowsTransponderOffTrade
!$sourceMarket.mc:free_market
$isPatrol
$sawPlayerTransponderOff score:100
$sawPlayerWithTOffCount > 1 score:100","$tOff_didAlready = true 0
MakeOtherFleetPreventDisengage tOff true
MakeHostileWhileTOff tOff true 7
$sawPlayerWithTOffCount++ 10
$ignorePlayerCommRequests = true 0",,,
tOffPatrolOpenComm,OpenCommLink,$entity.transponderOffConv score:100,"AddText ""\""Running with the transponder off in $faction space is against the law. You're hereby ordered to turn your transponder on, identify yourself immediately, and submit to a cargo scan for contraband.\""""
AdjustRep $faction.id TRANSPONDER_OFF
AdjustRepActivePerson TRANSPONDER_OFF",,"0:tOff_comply:Turn the transponder on and comply
1:tOff_refuse:Refuse and cut the comm link",
tOffPatrolOpenCommUnknown,OpenCommLink,"$entity.transponderOffConv score:100
!$entity.knowsWhoPlayerIs","AddText ""\""Unknown $shipOrFleet, identify yourself! Running with the transponder off in $faction space is against the law. You're hereby ordered to turn your transponder on and submit to a cargo scan.\""""
AdjustRep $faction.id TRANSPONDER_OFF
AdjustRepActivePerson TRANSPONDER_OFF",,"0:tOff_comply:Turn the transponder on and comply
1:tOff_refuse:Refuse and cut the comm link",
tOffPatrolOpenCommTOn,OpenCommLink,"$entity.transponderOffConv score:100
$player.transponderOn","AddText ""\""Running with the transponder off in $faction space is against the law. Don't think you can just turn it back on and avoid our attention - you're hereby ordered to submit to a cargo scan.\""""
AdjustRep $faction.id TRANSPONDER_OFF
AdjustRepActivePerson TRANSPONDER_OFF",,"0:tOff_comply2:Allow the scan
1:tOff_refuse:Refuse and cut the comm link",
tOffPatrolOpenCommNotFirstTime,OpenCommLink,"$entity.transponderOffConv score:100
$entity.sawPlayerWithTOffCount == 2.0 score:10
$entity.relativeStrength >= 0","AddText""\""I told you last time to keep your transponder on.\""""
AdjustRep $faction.id TRANSPONDER_OFF
AdjustRepActivePerson TRANSPONDER_OFF
AddText ""The comm link is cut before you have a chance to respond.""
$entity.ignorePlayerCommRequests = true 0
unset $entity.transponderOffConv",,0:tOff_notFirstTimeCont:Continue,
tOffPatrolOpenCommNotFirstTimeCont,DialogOptionSelected,$option == tOff_notFirstTimeCont,"MakeHostileWhileTOff tOff true 7
ShowDefaultVisual
EndConversation",,,
tOffComply,DialogOptionSelected,$option == tOff_comply,"unset $entity.transponderOffConv
unset $entity.sawPlayerTransponderOff
ActivateAbility $player.fleetId transponder
UpdateMemory",You issue an order to activate the transponder and wait for the cargo scan to finish.,0:tOff_scan_continue:Continue,
tOffComply2,DialogOptionSelected,$option == tOff_comply2,"unset $entity.transponderOffConv
unset $entity.sawPlayerTransponderOff",You wait for the cargo scan to finish.,0:tOff_scan_continue:Continue,
tOffCargoScan,DialogOptionSelected,$option == tOff_scan_continue,"AddText ""After a brief wait, the $faction $otherFleetName transmits the scan results.""
CargoScan
FireBest TOffScanResult",,,
tOffCargoScanHostile,DialogOptionSelected,"$option == tOff_scan_continue
$entity.isHostile","ShowDefaultVisual
EndConversation","However, instead of proceeding with the scan, the $faction $fleetName shuts down comms and powers up combat systems.",,
tOffCargoScanHostileStronger,DialogOptionSelected,"$option == tOff_scan_continue
$entity.isHostile
$entity.relativeStrength < 0","MakeOtherFleetAggressive tOff false
MakeOtherFleetPreventDisengage tOff false
ShowDefaultVisual
EndConversation","However, instead of proceeding with the scan, the $faction $fleetName shuts down comms and powers up combat systems.",,
tOffCargoScanPods,TOffScanResult,$scan_podsFound score:1000,unset $scan_podsFound,"The $faction $personRank pauses and looks off-screen.

""But what about these cargo pods, which, let me check - why, they do contain illegal cargo. Not yours, are they? No? Excellent. We'll be confiscating the contents, then.""",0:tOff_podsCont:Continue,
tOffCargoScanPodsCont,DialogOptionSelected,$option == tOff_podsCont,FireBest TOffScanResult,,,
tOffCargoScanClean,TOffScanResult,"!$scan_contrabandFound
!$scan_suspiciousCargoFound",,"$PersonRank $personName looks vaguely displeased.

""If I catch you running with the transponder off again, you won't get off so easily.""

The comm link is cut before you have a chance to respond.",0:tOff_cleanCont1:Continue,
tOffCargoScanSuspicious,TOffScanResult,$scan_suspiciousCargoFound,,"While the scan finds no overt contraband, the quantity of cargo found, combined with indirect evidence of your prior black market activities, is enough to raise suspicions.

It is not, however, enough to do anything about. Correspondingly, $personRank $personName looks displeased.

""I'll see you again, you can be sure of it,"" $heOrShe grinds out before cutting the comm link.",0:tOff_cleanCont1:Continue,
tOffCargoScanClean2,DialogOptionSelected,$option == tOff_cleanCont1,"MakeOtherFleetPreventDisengage tOff false
BroadcastCancelPlayerAction 5000 $sawPlayerTransponderOff
ShowDefaultVisual
EndConversation NO_CONTINUE
$sourceMarket.smugglingScanTimeout = true 30",,,
tOffCargoScanContraband,TOffScanResult,$scan_contrabandFound score:10,,"""Well, well. Just as I suspected, we've got a smuggler here. Per standard $faction procedure, you're required to eject the contraband into space, for pickup or incineration at the discretion of the patrol commander.""

$PersonRank $personLastName looks rather pleased, and you suspect that ""pickup"" rather than ""incineration"" might be the order of the day.","0:tOff_comply_contraband:Surrender the contraband and cut the comm link
1:tOff_refuse:Refuse and cut the comm link",
tOffCargoScanContrabandSurrender,DialogOptionSelected,$option == tOff_comply_contraband,"CargoScanApplyResult $scan_cargoScanResult
MakeOtherFleetPreventDisengage tOff false
BroadcastCancelPlayerAction 5000 $sawPlayerTransponderOff
ShowDefaultVisual
EndConversation
$sourceMarket.smugglingScanTimeout = true 30",,,
tOffRefuse,DialogOptionSelected,$option == tOff_refuse,"$entity.ignorePlayerCommRequests = true 0
unset $entity.transponderOffConv
AdjustRep $faction.id TRANSPONDER_OFF_REFUSE
AdjustRepActivePerson TRANSPONDER_OFF_REFUSE
MakeHostileWhileTOff tOff true 7
ShowDefaultVisual
EndConversation
$sourceMarket.smugglingScanTimeout = true 30",,,
# cargo scan from smuggling suspicion,,,,,,
cargoScanInitial,BeginFleetEncounter,"!$cargoScan_didAlready
!$isHostile
$pursuePlayer_smugglingScan score:50","$cargoScan_didAlready = true 0
MakeOtherFleetPreventDisengage cargoScan true
MakeOtherFleetAggressive cargoScan true
unset $ignorePlayerCommRequests
$cargoScanConv = true 0
AddText ""You're being hailed by the $faction $otherShipOrFleet."" $faction.baseColor
OpenComms",,,
cargoScanFirstComms,OpenCommLink,$entity.cargoScanConv score:100,"AddText ""\""Attention: your fleet matches the profile of a suspected smuggler posted by $market authorities. You're hereby ordered to submit to a cargo scan.\""""
",,"0:cargoScan_comply:Allow the scan
1:cargoScan_refuse:Refuse and cut the comm link",
,,,,,,
cargoScanStart,DialogOptionSelected,$option == cargoScan_comply,"AddText ""After a brief wait, the $faction $otherFleetName transmits the scan results.""
CargoScan
FireBest CargoScanResult",,,
cargoScanPods,CargoScanResult,$scan_podsFound score:1000,unset $scan_podsFound,"The $faction $personRank pauses and looks off-screen.

""But what about these cargo pods, which, let me check - why, they do contain illegal cargo. Not yours, are they? No? Excellent. We'll be confiscating the contents, then.""",0:scan_podsCont:Continue,
cargoScanPodsCont,DialogOptionSelected,$option == scan_podsCont,FireBest CargoScanResult,,,
cargoScanClean,CargoScanResult,"!$scan_contrabandFound
!$scan_suspiciousCargoFound",,"$PersonRank $personName looks vaguely displeased.

""Well, everything looks clean this time.""

The comm link is cut before you have a chance to respond.",0:cargoScan_cleanCont:Continue,
cargoScanSuspicious,CargoScanResult,$scan_suspiciousCargoFound,,"While the scan finds no overt contraband, the quantity of cargo found, combined with indirect evidence of your prior black market activities, is enough to raise suspicions.

It is not, however, enough to do anything about. Correspondingly, $personRank $personName looks displeased.

""I'll see you again, you can be sure of it,"" $heOrShe grinds out before cutting the comm link.",0:cargoScan_cleanCont:Continue,
cargoScanClean2,DialogOptionSelected,$option == cargoScan_cleanCont,"MakeOtherFleetPreventDisengage cargoScan false
MakeOtherFleetAggressive cargoScan false
unset $entity.pursuePlayer_smugglingScan
unset $entity.cargoScanConv
$entity.smugglingScanComplete = true 1
ShowDefaultVisual
EndConversation NO_CONTINUE",,,
cargoScanContraband,CargoScanResult,$scan_contrabandFound score:10,,"""Well, well. Just as I suspected, we've got a smuggler here. Per standard $faction procedure, you're required to eject the contraband into space, for pickup or incineration at the discretion of the patrol commander.""

$personRank $personLastName looks rather pleased, and you suspect that ""pickup"" rather than ""incineration"" might be the order of the day.","0:cargoScan_comply_contraband:Surrender the contraband and cut the comm link
1:cargoScan_refuse:Refuse and cut the comm link",
cargoScanContrabandSurrender,DialogOptionSelected,$option == cargoScan_comply_contraband,"CargoScanApplyResult $scan_cargoScanResult
MakeOtherFleetPreventDisengage cargoScan false
MakeOtherFleetAggressive cargoScan false
unset $entity.pursuePlayer_smugglingScan
unset $entity.cargoScanConv
$entity.smugglingScanComplete = true 1
ShowDefaultVisual
EndConversation",,,
cargoScanRefuse,DialogOptionSelected,$option == cargoScan_refuse,"$entity.ignorePlayerCommRequests = true 0
unset $entity.cargoScanConv
unset $entity.pursuePlayer_smugglingScan
$entity.smugglingScanComplete = true 1
AdjustRep $faction.id CARGO_SCAN_REFUSE
AdjustRepActivePerson CARGO_SCAN_REFUSE
ShowDefaultVisual
EndConversation",,,
,,,,,,
,,,,,,
,,,,,,
,,,,,,
,,,,,,
,,,,,,
,,,,,,
,,,,,,
,,,,,,
# Smuggling investigation inspector,,,,,,
ise_greetingTOn,PickGreeting,"$ise_investigator
$player.transponderOn
!CallEvent $ise_eventRef paidBribe",ShowPersonVisual,"After a short wait, your connection request is accepted.

$personName looks at you suspiciously.

""As I'm sure you're aware, I'm currently conducting a highly sensitive investigation, and have no time for idle chatter.""

You get the feeling that you might get further if you came into port without broadcasting your identity via the transponder.",0:cutCommLink:Cut the comm link,
ise_greetingTOff,PickGreeting,"$ise_investigator
!$player.transponderOn
!CallEvent $ise_eventRef paidBribe","ShowPersonVisual
FireAll PopulateOptionsISE","After a short wait, your connection request is accepted.

$personName looks at you for a moment or two before speaking.

""As I'm sure you're aware, I'm currently conducting a highly sensitive investigation.""",,
ise_greetingPaid,PickGreeting,"$ise_investigator
CallEvent $ise_eventRef paidBribe",EndConversation,"After a short wait, your connection request is rejected.",,
ise_offerBribe,PopulateOptionsISE,,,,"0:ise_offerBribe:""I understand running a thorough investigation can be expensive...""
1:cutCommLink:Cut the comm link",
ise_offerBribeSel,DialogOptionSelected,"$option == ise_offerBribe
$player.credits >= $ise_bribeAmount",SetTextHighlights $ise_bribeAmountDGS,"""I'm so glad to meet someone who understands the issues.

Having proper funding - say, an extra $ise_bribeAmountDGS credits - would ensure that this investigation could reach a speedy and satisfactory conclusion.""","0:ise_offerBribeAmount:Offer a ""donation"" of $ise_bribeAmountDGS credits
1:cutCommLink:Cut the comm link",
ise_offerBribeSelNotEnough,DialogOptionSelected,$option == ise_offerBribe,SetTextHighlights $ise_bribeAmountDGS,"""Your interest in the matter is duly noted, but it doesn't sound like you're really ready to help me resolve this misunderstanding. Something more like, oh, $ise_bribeAmountDGS credits? That could facilitate a proper investigation.""

""Now I have fascinating reports about you to read over, so come back when you're serious.""",0:cutCommLink:Cut the comm link,
ise_offerBribeAmountSel,DialogOptionSelected,$option == ise_offerBribeAmount,"AddText ""Lost $ise_bribeAmountDGS credits"" textEnemyColor
AddText ""\""Thank you, citizen. I'm sure my investigation will reach a proper conclusion in due time.\""""
SubCredits $ise_bribeAmount
CallEvent $ise_eventRef setBribePaid",,0:cutCommLink:Cut the comm link,
# Good reputation with other faction investigation inspector,,,,,,
igr_greetingTOn,PickGreeting,"$igr_investigator
$player.transponderOn
!CallEvent $igr_eventRef paidBribe",ShowPersonVisual,"After a short wait, your connection request is accepted.

$personName looks at you suspiciously.

""As I'm sure you're aware, I'm currently conducting a highly sensitive investigation, and have no time for idle chatter. Certainly not with someone that's known to be a person of interest.""

The slight emphasis on ""known"" gives you the feeling that you might get further if you came into port without broadcasting your identity via the transponder.",0:cutCommLink:Cut the comm link,
igr_greetingTOff,PickGreeting,"$igr_investigator
!$player.transponderOn
!CallEvent $igr_eventRef paidBribe",ShowPersonVisual,"After a short wait, your connection request is accepted.

$personName looks at you for a moment or two before speaking.

""As I'm sure you're aware, I'm currently conducting a highly sensitive investigation.""","0:igr_offerBribe:""I just want to make sure you have the resources for a thorough investigation...""
1:cutCommLink:Cut the comm link",
igr_greetingPaid,PickGreeting,"$igr_investigator
CallEvent $igr_eventRef paidBribe",EndConversation,"After a short wait, your connection request is rejected.",,
igr_greetingReject,PickGreeting,"$igr_investigator
$personFaction.numGRInvestigations >= 2 score:100",ShowPersonVisual,"After a short wait, your connection request is accepted.

$personName looks at you for a moment or two before speaking.

""As I'm sure you're aware, I'm currently conducting a highly sensitive investigation.""","0:igr_offerBribe:""I just want to make sure you have the resources for a thorough investigation...""
1:cutCommLink:Cut the comm link",
igr_offerBribeSel,DialogOptionSelected,"$option == igr_offerBribe
$player.credits >= $igr_bribeAmount",SetTextHighlights $igr_bribeAmountDGS,"""I'm so glad to meet someone who understands the difficulties involved.

Having proper funding - say, an extra $igr_bribeAmountDGS credits - would ensure that this investigation could reach a speedy and satisfactory conclusion.""","0:igr_offerBribeAmount:Offer a ""donation"" of $igr_bribeAmountDGS credits
1:cutCommLink:Cut the comm link",
igr_offerBribeRejectedSel,DialogOptionSelected,"$option == igr_offerBribe
$personFaction.numGRInvestigations >= 2 score:100",,"""Your concern is noted, citizen, but $thePersonFaction is providing me with all the resources I need.""",0:cutCommLink:Cut the comm link,
igr_offerBribeSelNotEnough,DialogOptionSelected,$option == igr_offerBribe,SetTextHighlights $igr_bribeAmountDGS,"""Your interest in the matter is duly noted, but it doesn't sound like you're really ready to help me resolve this misunderstanding. Something more like, oh, $ise_bribeAmountDGS credits? That could facilitate a proper investigation."" 

""Now I have some fascinating reports about you to review, so come back when you're serious.""",0:cutCommLink:Cut the comm link,
igr_offerBribeAmountSel,DialogOptionSelected,$option == igr_offerBribeAmount,"AddText ""Lost $igr_bribeAmountDGS credits"" textEnemyColor
AddText ""\""Thank you, citizen. I'm sure my investigation will reach a proper conclusion in due time.\""""
SubCredits $igr_bribeAmount
CallEvent $igr_eventRef setBribePaid
FireBest IGRBribeEnd",,,
igr_offerBribeAccepedEndWarning,IGRBribeEnd,$personFaction.numGRInvestigations == 1,,"$personName hesitates and switches to a more secure channel before speaking.

""I'm telling you this because I don't want you to think that I haven't been looking out for you. There's considerable pressure from the top for this investigation to reach certain conclusions.

Should there be another $personFaction investigation into your ties with any other factions, I don't think you'll be able to influence the outcome.""",0:cutCommLink:Cut the comm link,
igr_offerBribeAccepedEndNormal,IGRBribeEnd,,,,0:cutCommLink:Cut the comm link,
,,,,,,
remnantStationFleetOpenDefault,BeginFleetEncounter,"$isStation
$faction.id == remnant
!$printedDesc",$printedDesc = true 0,"The grim expanse of the remnant battlestation fills your viewscreen. A bridge officer re-scales the tactical target display so that its entire mass can be seen at once. 

A relic from the First AI War, the station nonetheless appears to be fully armed and operational.

The combat analysis system churns for a few seconds and then beeps angrily instead of producing the usual range of tactical recommendations.",,
remnantStationFleetOpenDamaged,BeginFleetEncounter,"$isStation
$damagedStation
$faction.id == remnant
!$printedDesc",$printedDesc = true 0,"The grim expanse of the remnant battlestation fills your viewscreen. A bridge officer re-scales the tactical target display so that its entire mass can be seen at once. 

A relic from the First AI War, the station's long arc gapes with empty sockets where weapons platforms and citadels once present. Despite the obvious damage, the station is armed and operational.

The combat analysis system churns for a few seconds and then beeps angrily instead of producing the usual range of tactical recommendations.",,
# SALVAGE,,,,,,
sal_default,OpenInteractionDialog,$tag:salvageable,"SalvageGenFromSeed
FireBest ShowSalvageEntityDetails
FireBest SalvageCheckHostile",,,
sal_derelictDefault,OpenInteractionDialog,"$tag:salvageable
$faction.id == derelict","SalvageGenFromSeed
FireBest ShowSalvageEntityDetails
FireBest SalvageCheckHostile",Your $shipOrFleet approaches a $nameInText left from the initial Domain exploration of the Sector.,,
sal_scavengeDebris,OpenInteractionDialog,"$tag:salvageable
$customType == debris_field_shared score:100","SalvageGenFromSeed
ShowDefaultVisual
SalvageEntity descDebris
FireBest SalvageCheckHostile",Your $shipOrFleet assumes a stable orbit relative to the debris field.,,
,,,,,,
sal_hostileNearby,SalvageCheckHostile,HostileFleetNearbyAndAware,SetShortcut defaultLeave ESCAPE,"A nearby hostile fleet is tracking your movements, making exploration impossible.",100:defaultLeave:Leave,
sal_noHostileNearby,SalvageCheckHostile,!HostileFleetNearbyAndAware,FireAll PopulateSalvageOptions1,,,
,,,,,,
# Details/description printed on initial interaction,,,,,,
sal_defaultDetails,ShowSalvageEntityDetails,,"ShowDefaultVisual
PrintDescription 1",,,
sal_probeDetails,ShowSalvageEntityDetails,$customType == derelict_probe,"ShowDefaultVisual
FireBest DerelictPrintExtraInfo","Pitted by small impacts, the probe's hull displays iridescence typical of fearsome radiation scarring. Though this probe's manufacture could well date to a thousand cycles ago, some systems are still nominally active.",,
sal_surveyShipDetails,ShowSalvageEntityDetails,$customType == derelict_survey_ship,"ShowDefaultVisual
FireBest DerelictPrintExtraInfo",The ancient Domain-era automated survey ship has been ravaged by centuries of exposure to charged particles and high velocity impacts of interstellar dust. Some systems still appear to be nominally active.,,
sal_mothershipDetails,ShowSalvageEntityDetails,$customType == derelict_mothership,"ShowDefaultVisual
FireBest DerelictPrintExtraInfo","The vast bulk of the automated exploration mothership is burned and battered by centuries of service to the Domain, a drifting forgotten hulk, though sensors indicate that some systems are still nominally active.",,
sal_derelictDefConstructionInfo,DerelictPrintExtraInfo,$global.defeatedDerelictStr >= 50,,"Sensor returns indicate unusually short-lived charged particles near the derelict. Density distribution in the internal structure has also changed from patterns extrapolated from your previous encounters with Domain-era exploration vessels, as if internal masses have been removed or intentionally redistributed.",,
sal_wreckDetails,ShowSalvageEntityDetails,$customType == wreck,"ShowDefaultVisual
PrintWreckDescription",,,
,,,,,,
# Explore/Leave options and actions,,,,,,
sal_defaultLeave1,PopulateSalvageOptions1,,SetShortcut defaultLeave ESCAPE,,100:defaultLeave:Leave,
sal_explore,PopulateSalvageOptions1,$customType != debris_field_shared,,,0:salExplore:Explore,
sal_assess,PopulateSalvageOptions1,$customType == debris_field_shared,,,0:salExplore:Assess,
sal_defenders,DialogOptionSelected,"$option == salExplore
$hasDefenders",FireBest TriggerAutomatedDefenses,,,
sal_noDefenders,DialogOptionSelected,$option == salExplore,FireBest CheckSalvageSpecial,,,
,,,,,,
# Descriptions of automated defenders,,,,,,
sal_printDefaultDefenders,TriggerAutomatedDefenses,,SalvageDefenderInteraction,"As your $shipOrFleet moves in closer, new energy signatures are detected near the $shortName.",,
sal_printDebrisDefenders,TriggerAutomatedDefenses,$customType == debris_field_shared,SalvageDefenderInteraction,"As your $shipOrFleet moves in closer, new energy signatures are detected near a larger pieces of debris.",,
sal_triggerProbeDefenders,TriggerAutomatedDefenses,$customType == derelict_probe,SalvageDefenderInteraction,"As your $shipOrFleet moves in closer, several energy signatures are detected coming online inside the probe's hold.",,
sal_triggerSurveyShipDefenders,TriggerAutomatedDefenses,$customType == derelict_survey_ship,SalvageDefenderInteraction,"As your $shipOrFleet moves in closer, multiple energy signatures are detected coming online from various points on and within the flayed hull of the survey ship.",,
sal_triggerMothershipDefendersBoth,TriggerAutomatedDefenses,"$customType == derelict_mothership
$hasStation
$hasNonStation",SalvageDefenderInteraction,"As your $shipOrFleet moves in closer, numerous strong energy signatures are detected coming online inside the darkened work-bays of the mothership's vast hulk. Your sensors also detect several weapon empacements powering up on the mothership itself.",,
sal_triggerMothershipDefendersOnlyDrones,TriggerAutomatedDefenses,"$customType == derelict_mothership
$hasNonStation",SalvageDefenderInteraction,"As your $shipOrFleet moves in closer, numerous strong energy signatures are detected coming online inside the darkened work-bays of the mothership's vast hulk.",,
sal_triggerMothershipDefendersOnlyItself,TriggerAutomatedDefenses,"$customType == derelict_mothership
$hasStation",SalvageDefenderInteraction,"As your $shipOrFleet moves in closer, your sensors detect several weapon empacements powering up in darkened crevasses on the mothership's vast hulk.",,
,,,,,,
"# Checking whether salvage results in a ""special"" find. This is where SalvageDefenderInteraction returns to.",,,,,,
sal_continuePostDefenders,BeatDefendersContinue,,,Your $shipOrFleet finishes its approach to the $nameInText without further incident.,0:salBeatDefendersContinue:Continue,
sal_continuePostDefendersDerelict,BeatDefendersContinue,$faction.id == derelict,,"As your $shipOrFleet finishes mopping up the automated defenses, a weak hyperwave ping is detected coming from the $shortName. It's unclear if this is random noise from a dying subsystem or some kind of encrypted signal.

Your $shipOrFleet finishes its approach to the $nameInText without further incident.",0:salBeatDefendersContinue:Continue,
sal_continuePostDefendersSelected,DialogOptionSelected,$option == salBeatDefendersContinue,FireBest CheckSalvageSpecial,,,
sal_checkSpecialFound,CheckSalvageSpecial,$salvageSpecialData != null,"ShowDefaultVisual
SalvageSpecialInteraction",,,
,,,,,,
"# If no special, go right to salvage. If there was a special, ""Continue"" to go to salvage",,,,,,
sal_checkSpecialNoneFound,CheckSalvageSpecial,,"ShowDefaultVisual
FireBest BeginSalvage",,,
sal_specialFinished,SalvageSpecialFinished,,,,0:salSpecialContinue:Continue,
sal_specialContinueSelected,DialogOptionSelected,$option == salSpecialContinue,FireBest BeginSalvage,,,
sal_specialFinishedNoContinue,SalvageSpecialFinishedNoContinue,,FireBest BeginSalvage,,,
,,,,,,
# Actual salvage process,,,,,,
sal_showRatingAndCost,BeginSalvage,,"SalvageEntity showCost
FireAll PopulateSalvageOptions2",,,
sal_optionLeave,PopulateSalvageOptions2,,SetShortcut defaultLeave ESCAPE,,100:defaultLeave:Leave,
sal_optionSalvageDisabledCost,PopulateSalvageOptions2,"!$canSalvage
!$canAffordSalvage
$canDoSalvageRating","SetEnabled salSalvage false
SetTooltip salSalvage ""Your fleet does not have the necessary resources to run a proper salvage operation here.""",,0:salSalvage:Begin salvage operations,
sal_optionSalvageDisabledRating,PopulateSalvageOptions2,"!$canSalvage
$canAffordSalvage
!$canDoSalvageRating","SetEnabled salSalvage false
SetTooltip salSalvage ""The salvage difficulty rating is too high for you to perform a proper salvage operation.""",,0:salSalvage:Begin salvage operations,
sal_optionSalvageDisabledBoth,PopulateSalvageOptions2,"!$canSalvage
!$canDoSalvageRating
!$canAffordSalvage","SetEnabled salSalvage false
SetTooltip salSalvage ""The salvage difficulty rating is too high for you to perform a proper salvage operation. In addition, your fleet does not have the necessary resources to run a proper salvage operation here.""",,0:salSalvage:Begin salvage operations,
sal_optionSalvageEnabled,PopulateSalvageOptions2,$canSalvage,,,0:salSalvage:Begin salvage operations,
sal_optionDemolish,PopulateSalvageOptions2,$customType != debris_field_shared,"SetTooltip salDemolish ""Scavenging through the resulting debris field will produce about half the salvage, compared to a proper salvage operation.""",,1:salDemolish:Pound it into scrap,
sal_optionCheckAccidents,DialogOptionSelected,$option == salSalvage,SalvageEntity checkAccidents,,,
sal_salvageOptionSelected,DialogOptionSelected,$option == salPerform,SalvageEntity performSalvage,,,
sal_demolishOptionSelected,DialogOptionSelected,$option == salDemolish,SetShortcut defaultLeave ESCAPE,Salvage crews set targeting beacons at key points in the structure.,"0:salDemolishConfirm:Give the order to fire
100:defaultLeave:Leave",
sal_demolishOptionConfirmed,DialogOptionSelected,$option == salDemolishConfirm,SalvageEntity demolish,,,
,,,,,,
,,,,,,
# CARGO PODS,,,,,,
pods_start,OpenInteractionDialog,$customType == cargo_pods,"ShowDefaultVisual
CargoPods printDesc
FireAll CargoPodsOptions
FireAll CargoPodsOptionsUpdate",,,
pods_open,CargoPodsOptions,!$locked,,,0:podsOpen:Examine pod contents,
pods_leave,CargoPodsOptions,,SetShortcut defaultLeave ESCAPE,,100:defaultLeave:Leave,
pods_stabilize,CargoPodsOptions,,,,1:podsStabilize:Put the pods into a stable orbit,
pods_stabilizeDisable,CargoPodsOptionsUpdate,$inHyperspace,"SetEnabled podsStabilize false
SetTooltip podsStabilize ""Can not be done in hyperspace.""",,,
pods_stabilizeDisableDidAlready,CargoPodsOptionsUpdate,"!$inHyperspace
$stabilized
$daysLeft > 90","SetEnabled podsStabilize false
SetTooltip podsStabilize ""The pods are already in a semi-stable orbit and further efforts will not yield meaningful results.""",,,
pods_break,CargoPodsOptions,"$locked
!$canUnlock",,,"0:podsBreak:Blast the locks open
100:defaultLeave:Leave",
pods_unlock,CargoPodsOptions,"$locked
$canUnlock",,,"0:podsOpen:Transmit the keycode and examine the contents
100:defaultLeave:Leave",
pods_openOption,DialogOptionSelected,$option == podsOpen,"unset $locked
unset $trapped
CargoPods openCargo",,,
pods_breakOption,DialogOptionSelected,"$option == podsBreak
!$trapped","CargoPods breakLocks
unset $locked
unset $trapped",,,
pods_breakOption2,DialogOptionSelected,"$option == podsBreak
$trapped",CargoPods destroy,"Unfortunately, the pods were wired to explode unless the correct authorization code was given, and the cargo is destroyed in its entirety.",100:defaultLeave:Leave,
pods_stabilizeSel,DialogOptionSelected,$option == podsStabilize,"CargoPods computeStabilizeData
AddText ""Stabilizing the orbit of the cargo pods will require $stabilizeSupplies supplies and will put them on a stable orbit for approximately $stabilizeDays days.""
SetTextHighlights $stabilizeSupplies $stabilizeDays
AddText ""Adding or removing any cargo afterwards will destabilize the orbit.""
FireBest CargoPodsShowAvailableSupplies",,"0:podsStabConfirm:Proceed
1:podsStabAbort:Never mind",
pods_stabilizeSuppliesEnough,CargoPodsShowAvailableSupplies,$stabilizeSupplies < $player.supplies,SetTextHighlights $player.supplies,You have $player.supplies supplies available.,,
pods_stabilizeSuppliesNotEnough,CargoPodsShowAvailableSupplies,$stabilizeSupplies >= $player.supplies,"SetTextHighlightColors bad
SetTextHighlights $player.supplies
SetEnabled podsStabConfirm false",You have $player.supplies supplies available.,,
pods_stabConfirmSel,DialogOptionSelected,$option == podsStabConfirm,"CargoPods stabilize
FireAll CargoPodsOptions
FireAll CargoPodsOptionsUpdate",,,
pods_stabAbortSel,DialogOptionSelected,$option == podsStabAbort,"FireAll CargoPodsOptions
FireAll CargoPodsOptionsUpdate",,,
,,,,,,
,,,,,,
# luddic shrine interaction test by David! (Having some Fun.),,,,,,
shrineOpenDialog,OpenInteractionDialog,$tag:luddicShrine,"PrintDescription 1
AddText ""The landing bay is filled with parties of Luddic pilgrims dressed in traditional handweave meeting with subcurates. An attendant looks you over suspiciously and inquires about what business you have coming here.""
ShowDefaultVisual
FireBest ShrineMainOptions",,,
shrineMainOptions,ShrineMainOptions,,"SetShortcut shrineLeave ""ESCAPE""",,"0:shrineVisit:Visit
1:shrineMakeOffering:Make an offering
10:shrineLeave:Leave",
shrineVisit,DialogOptionSelected,$option == shrineVisit,"SetShortcut shrineLeave ""ESCAPE""","The attendant receives your request with only the subtlest disapproval. To your surprise, a subcurate approaches to escort you to the shrine's viewing chamber.

A vast, dim gallery opens upon a hundred-meter diamond plate window allowing a full view of the glory of Kumari Aru. Here, pilgrims quietly contemplate the miracle of Creation, taking in the sublime and terrible beauty of the gas giant looming below. Storm systems the size of a standard terrestrial worlds churn with slow majesty, inner-lit with green-violet sheet lightning, teeming with xenolife. Does something incomprehensible look up from the lee of a dark cloudbank at the bright point in that alien sky?

After a time, you return to your ship.",shrineLeave:Leave,
shrineLeave,DialogOptionSelected,$option == shrineLeave,DismissDialog,,,
,,,,,,
shrineOfferingAlreadyMade,DialogOptionSelected,"$option == shrineMakeOffering
$offeringMade score:100",,You've made a contribution recently so providing another at this time might be viewed as an unseemly act of pride.,,
shrineOfferingEnough,DialogOptionSelected,"$option == shrineMakeOffering
$player.supplies >= 10","SetTextHighlightColors buttonShortcut
SetTextHighlights 10","You inquire with the subcurate about the possibility of contributing to the maintenance of this holy site. With a warm smile, the subcurate explains that an offering of 10 units of supplies would do much to assist the Church in its observance of sacred duties.","0:shrineGiveOffering:Give 10 supplies
1:shrineCancelOffering:Never mind",
shrineOfferingNotEnough,DialogOptionSelected,"$option == shrineMakeOffering
$player.supplies < 10","SetTextHighlightColors buttonShortcut
SetTextHighlights 10","You inquire with the subcurate about the possibility of contributing to the maintenance of this holy site. An offering of 10 units of supplies would do much to assist the Church in its observance of sacred duties. Unfortunately you do not have enough supplies on hand.

The subcurate gives a sad smile. ""I see that your intent is good. Perhaps you would like to attend the free lunch we offer?""",,
shrineGiveOffering,DialogOptionSelected,$option == shrineGiveOffering,"AddText ""A subcurate accepts your offering with prayer and thanks.""
AddRemoveCommodity supplies -10 true
AdjustRep luddic_church SHRINE_OFFERING
$offeringMade = true 60
FireBest ShrineMainOptions",,,
shrineCancelOffering,DialogOptionSelected,$option == shrineCancelOffering,FireBest ShrineMainOptions,,,
,,,,,,
# AnalyzeEntityMission entity interaction,,,,,,
aem_runSensorPackageOptionHostile,OpenInteractionDialog,"$aem_target score:1000
HostileFleetNearbyAndAware","ShowDefaultVisual
SetShortcut defaultLeave ESCAPE","Your $shipOrFleet gets within range of the $nameInText that you've been contracted to run a black-box sensor package on.

However, a hostile fleet is tracking your movements, leaving you no time to stop and run the sensor package.",100:defaultLeave:Leave,
aem_runSensorPackageOption,OpenInteractionDialog,"$aem_target score:1000
!HostileFleetNearbyAndAware","ShowDefaultVisual
SetShortcut defaultLeave ESCAPE",Your $shipOrFleet gets within range of the $nameInText that you've been contracted to run a black-box sensor package on.,"0:aem_runPackage:Run the sensor package
100:defaultLeave:Leave",
aem_runSensorPackageOptionSel,DialogOptionSelected,$option == aem_runPackage,CallEvent $aem_eventRef runPackage,"You tap a button to execute the black-box sensor package and wait for it to finish. On completion, it provides an escrow key that authorizes the agreed-upon payment to be transferred to your account.

Presumably, it will transmit the scan results on a secure channel when you're near a comm relay, and then delete itself from your systems.",0:aem_continue:Continue,
aem_continueOptionSel,DialogOptionSelected,$option == aem_continue,FireBest OpenInteractionDialog,,,
,,,,,,
# SurveyPlanetMission,,,,,,
aem_planetApproach,OtherPlanetInteractionText,"$market.isPlanetConditionMarketOnly
!$market.isSurveyed
$spm_target",,It's the planet you've been contracted to run a full survey on.,,
aem_surveyFinished,PopulateOptions,"$market.isPlanetConditionMarketOnly
$market.isSurveyed
$spm_target",CallEvent $spm_eventRef finishedSurvey,"Once you have the survey data, the mission adjunct in your system provides an escrow key that authorizes the agreed-upon payment to be transferred to your account.

Presumably, it will transmit the survey data on a secure channel when you're near a comm relay, and then delete itself from your systems.",,
,,,,,,
# turning AI cores in,,,,,,
aiCores_turnInOption,PopulateOptions,"$isPerson
AICores personCanAcceptCores",FireBest DisableTurnInCoresOptionIfNeeded,,"10:aiCores_startTurnIn:""I'd like to turn in these AI cores that I've acquired...""",
aiCores_disableTurnInOption,DisableTurnInCoresOptionIfNeeded,!AICores playerHasCores,"SetTooltip aiCores_startTurnIn ""You do not have any AI cores in your posession.""
SetEnabled aiCores_startTurnIn false",,,
aiCores_turnInOptionSelGeneric,DialogOptionSelected,$option == aiCores_startTurnIn,FireAll PopulateCoresTurnInOptions,"""A fascinating offer. Why, if one of the major factions caught you with these, they might just seize them outright. Tell you what - I'll do you a favour and give you a good price.""",,
aiCores_turnInOptionSelLuddic,DialogOptionSelected,"$option == aiCores_startTurnIn
$faction.id == luddic_church",FireAll PopulateCoresTurnInOptions,"""You were right to bring these to me. I shall contact the Knight Commander to take possession of these abominations so that they may be properly cleansed.""",,
aiCores_turnInOptionSelHegemony,DialogOptionSelected,"$option == aiCores_startTurnIn
$faction.id == hegemony",FireAll PopulateCoresTurnInOptions,"""We don't generally like the public to be aware that these exist, citizen, but the Hegemony is treaty-bound to take posession of any such objects and ensure they're destroyed.""",,
aiCores_turnInOptionSelDiktat,DialogOptionSelected,"$option == aiCores_startTurnIn
$faction.id == sindrian_diktat",FireAll PopulateCoresTurnInOptions,"""A dangerous catch you have there - there's no telling what could happen if one got into the hands of terrorists. I ... that is, we, are sure to be rewarded by the Lion for surrendering this to Diktat Intelligence straightaway.""
OR
""It's a good thing you came directly to me; a less understanding officer might have you arrested for transporting material deemed a threat to the interests of the Sindrian Cause. Your loyalty shall be rewarded.""",,
aiCores_turnInOptionSelTriTachyon,DialogOptionSelected,"$option == aiCores_startTurnIn
$faction.id == tritachyon",FireAll PopulateCoresTurnInOptions,"""You hold quite the object of fascination there, though you are surely aware that you lack the expertise and capital necessary to exploit its full potential. The TriTachyon Corporation would be more than pleased to offer you a fair market price for your goods.""",,
aiCores_turnInOptionSelPerseanKazeron,DialogOptionSelected,"$option == aiCores_startTurnIn
$faction.id == persean
$market.id == kazeron",FireAll PopulateCoresTurnInOptions,"""An excellent find, citizen. The polity of Kazeron, and of course the Persean League as a whole, will recognize and reward your fulfillment of patriotic duty in assisting in finding these dangerous objects.""",,
aiCores_turnInOptionSelPerseanNotKazeron,DialogOptionSelected,"$option == aiCores_startTurnIn
$faction.id == persean
$market.id != kazeron",FireAll PopulateCoresTurnInOptions,"""An excellent find, citizen. We can't allow factions that would seek to impose their tyranny over our Sector to accumulate these dangerous objects.""",,
aiCores_playerHasOption,PopulateCoresTurnInOptions,,,,0:aiCores_selectCores:Select AI cores to turn in,
aiCores_neverMindOption,PopulateCoresTurnInOptions,,,,"100:aiCores_neverMind:""Never mind, I don't actually have any.""",
aiCores_neverMindOptionSelected,DialogOptionSelected,$option == aiCores_neverMind,FireAll PopulateOptions,,,
aiCores_turnInOptionSelected,DialogOptionSelected,$option == aiCores_selectCores,AICores selectCores,,,
aiCores_turnInResponseDefault,AICoresTurnedIn,,FireAll PopulateOptions,$PersonRank $personLastName thanks you and the conversation moves on to other matters.,,
aiCores_turnInResponseHegemony,AICoresTurnedIn,$faction.id == hegemony,FireAll PopulateOptions,$PersonRank $personLastName thanks you on behalf of the Hegemony Council and the conversation moves on to other matters.,,
aiCores_turnInResponseLuddicChurch,AICoresTurnedIn,$faction.id == luddic_church,FireAll PopulateOptions,$PersonRank $personLastName says a quick prayer and thanks you on behalf of the Church.,,
aiCores_turnInResponseDiktat,AICoresTurnedIn,$faction.id == sindrian_diktat,FireAll PopulateOptions,$PersonRank $personLastName salutes in an energetic display of loyalty to the Sindrian Cause before allowing you to turn to other matters.,,
aiCores_turnInResponseTriTachyon,AICoresTurnedIn,$faction.id == tritachyon,FireAll PopulateOptions,"$personName smiles like a carnivorous animal you saw in a holodoc once.  ""It's a deal.""",,
aiCores_turnInResponseLeagueKazeron,AICoresTurnedIn,"$faction.id == persean
$market.id == kazeron",FireAll PopulateOptions,$PersonRank $personLastName verifies the transfer before moving the conversation to other matters.,,
aiCores_turnInResponseLeagueOther,AICoresTurnedIn,"$faction.id == persean
$market.id != kazeron",FireAll PopulateOptions,$PersonRank $personLastName thanks you for your devotion to the cause of an independent Persean Sector.,,
,,,,,,
# distress call related,,,,,,
dstr_normalStart,BeginFleetEncounter,"!$isHostile
$distress score:1000
!$distressNoHail","AddText ""You're being hailed."" $faction.baseColor",,,
dstr_openComms,OpenCommLink,"!$isHostile
!$distressTalkedToPlayerBefore
$entity.distress score:1000","CallEvent $entity.ne_eventRef initDistress
AddText ""\""Thank the stars you showed up!""
AddText ""Our tanker had an accident and we don't have enough fuel left to get back to the core worlds. We need $entity.distressFuel fuel and will gladly pay you $entity.distressCredits credits for it - a handsome markup, I might add.\""""
SetTextHighlights $entity.distressFuel $entity.distressCredits
$distressTalkedToPlayerBefore = true
FireBest DistressShowAidOptions",,,
dstr_openCommsLuddic,OpenCommLink,"!$isHostile
!$distressTalkedToPlayerBefore
$entity.distress score:1000
$faction.id == luddic_church","CallEvent $entity.ne_eventRef initDistress
AddText ""\""Praise to providence and Ludd! You have come for us!""
AddText ""Our tanker had an accident and we don't have enough fuel left to get back to the core worlds. We need $entity.distressFuel fuel and will gladly pay you $entity.distressCredits credits for it - a charitable markup, I might add.\""""
SetTextHighlights $entity.distressFuel $entity.distressCredits
$distressTalkedToPlayerBefore = true
FireBest DistressShowAidOptions",,,
dstr_openCommsRepeat,OpenCommLink,"!$isHostile
$entity.distress score:1000","CallEvent $entity.ne_eventRef initDistress
AddText ""\""You're back!""
AddText ""You haven't come into more fuel, have you? We need $entity.distressFuel fuel and will gladly pay $entity.distressCredits credits for it.\""""
SetTextHighlights $entity.distressFuel $entity.distressCredits
FireBest DistressShowAidOptions",,,
dstr_aidOptions,DistressShowAidOptions,,"$cutCommLinkPolite = true 0
FireBest DistressShowAvailableFuel
FireBest UpdateDstrCrewOption",,"dstrSell:""Sounds reasonable - we'll provide the fuel.""
dstrGive:""No need for payment - I'm not one to gouge someone when they're down.""
dstrCrew:""How about I take on some of your crew instead?""
dstrDeny:""I'm sorry, we don't have enough to spare right now.""",
dstr_showEnoughFuel,DistressShowAvailableFuel,$player.fuel >= $entity.distressFuel,SetTextHighlights $player.fuel,You have $player.fuel fuel available.,,
dstr_updateCrewOption,UpdateDstrCrewOption,$player.crewRoom < 1,"SetTooltip dstrCrew ""Your $shipOrFleet does not have room to take on any more crew.""
SetEnabled dstrCrew false",,,
dstr_showNotEnoughFuel,DistressShowAvailableFuel,$player.fuel < $entity.distressFuel,"SetTextHighlightColors bad
SetTextHighlights $player.fuel
SetEnabled dstrSell false
SetEnabled dstrGive false",You have $player.fuel fuel available.,,
dstr_sellFuel,DialogOptionSelected,$option == dstrSell,"CallEvent $entity.ne_eventRef sellDistressFuel
AddText ""\""Thank you! I owe you one.\""""
FireAll PopulateOptions",,,
dstr_sellFuelLuddic,DialogOptionSelected,"$option == dstrSell
$faction.id == luddic_church","CallEvent $entity.ne_eventRef sellDistressFuel
AddText ""\""My thanks, and blessing of Ludd be upon you!\""""
FireAll PopulateOptions",,,
dstr_sellFuelTookCrew,DialogOptionSelected,"$option == dstrSell
$entity.playerTookDistressCrewRecently","CallEvent $entity.ne_eventRef sellDistressFuel
AddText ""\""Don't get me wrong, we'll take the fuel. But taking some of my crew first was a dirty trick.\""""
$cutCommLinkPolite = false 0
FireAll PopulateOptions",,,
dstr_giveFuel,DialogOptionSelected,$option == dstrGive,"CallEvent $entity.ne_eventRef giveDistressFuel
AddText ""\""Thank you! I won't forget this, and I'll make sure others know you can be counted on.\""""
FireAll PopulateOptions",,,
dstr_giveFuelTookCrew,DialogOptionSelected,"$option == dstrGive
$entity.playerTookDistressCrewRecently","CallEvent $entity.ne_eventRef giveDistressFuel
AddText ""\""First you take some of my crew, then you give me free fuel? It'd be a dirty trick if you *sold* the fuel, but you're giving it away for free. I'm not ashamed to admit, I don't understand your thought process - but... thank you? I guess?\""""
$cutCommLinkPolite = false 0
FireAll PopulateOptions",,,
dstr_takeCrewNo,DialogOptionSelected,"$option == dstrCrew
$entity.distressTurnHostile",SetEnabled dstrCrew false,"""What, you want to steal some of my crew under the guise of offering to 'help'? I don't think so!

You're obligated to render what aid you can, so - how about that fuel?""",,
dstr_takeCrewNotEnoughRoom,DialogOptionSelected,$option == dstrCrew,SetTextHighlights $entity.distressCrewTakeOn,"""That's a tough choice to make, but if the alternative is leaving some crew behind in cryopods to hopefully return for later...""

$HeOrShe pauses, clearly thinking things through.

""Let me see... will you take on $entity.distressCrewTakeOn crew? That should be within your $shipOrFleet's personnel capacity.

It's won't let us scuttle enough ships to reduce fuel consumption and be able to strike for the core worlds, but at least they'll be safe.""","dstrAcceptCrew:""Certainly.""
dstrRejectCrew:""I've changed my mind.""",
dstr_takeCrewEnoughRoom,DialogOptionSelected,"$option == dstrCrew
$entity.distressCrewTakeOn >= $entity.distressCrew",SetTextHighlights $entity.distressCrewTakeOn,"""That's a tough choice to make, but if the alternative is leaving some crew behind in cryopods to hopefully return for later...""

$HeOrShe pauses, clearly thinking things through.

""With fewer crew to support, we can scuttle some of our ships.

That'll get us some anti-matter from reactor cores, and with fewer ships, what fuel we have will go farther. We just might be able to make it back.

Let me see... will you take on $entity.distressCrewTakeOn crew? That should be within your $shipOrFleet's capacity.""","dstrAcceptCrew:""Certainly.""
dstrRejectCrew:""I've changed my mind.""",
dstr_rejectCrewSel,DialogOptionSelected,$option == dstrRejectCrew,FireBest DistressShowAidOptions,"""Any chance of selling us that fuel, then?""",,
dstr_acceptCrewSel,DialogOptionSelected,$option == dstrAcceptCrew,"CallEvent $entity.ne_eventRef takeDistressCrew
$entity.playerTookDistressCrewRecently = true 7
AddText ""\""Thanks for your help. We'll see what we can do over here.\""""
$entity.distressNoHail = true
FireAll PopulateOptions",,,
dstr_denySel,DialogOptionSelected,$option == dstrDeny,"$entity.distressNoHail = true
EndConversation NO_CONTINUE","""We'll just have to make do somehow, then. I expect you'll let others know of our plight.""

The comm link is cut rather abruptly.",,
dstr_denyTurnHostileSel,DialogOptionSelected,"$option == dstrDeny
$entity.relativeStrength >= 0
$entity.distressTurnHostile
$player.fuel > $entity.distressFuelHostileThreshold",,"""Is that so? I think we'll just have to open up your fuel tanks and make sure. Because our sensors certainly show otherwise.""","dstrScared:""Ok, ok! You can have the fuel.""
dstrDefiant:""Give it your best shot, why don't you.""",
dstr_scaredSel,DialogOptionSelected,$option == dstrScared,"CallEvent $entity.ne_eventRef scaredDistressFuel
AddText ""\""Glad you could see reason. Helping a fellow traveler is only what's right, after all.\""""
AddText ""The comm link is cut while you're still contemplating the audacity of that statement, and your own dwindling fuel reserves.""
EndConversation NO_CONTINUE",,,
dstr_defiantSel,DialogOptionSelected,$option == dstrDefiant,"MakeOtherFleetHostile distress true 1000
MakeOtherFleetAggressive distress true 1000
MakeOtherFleetLowRepImpact distress true 1000
unset $entity.distress
$ignorePlayerCommRequests = true
EndConversation NO_CONTINUE","""Alright then, we'll do it the hard way.""

The comm link is cut before you have a chance to respond.",,
,,,,,,
# player distress call response - buying supplies and fuel,,,,,,
dcall_normalStart,BeginFleetEncounter,"!$isHostile
$distressResponse score:1000
!$distressNoHail","AddText ""You're being hailed."" $faction.baseColor",,,
dcall_openCommsInhospitable,OpenCommLink,"!$isHostile
RepIsAtBest $faction.id INHOSPITABLE
$entity.distressResponse score:1000","DistressResponse unrespond
$entity.ignorePlayerCommRequests = true
FireAll PopulateOptions","""Oh, it's you. I've heard about you. You're on your own.""
OR
""You?"" $HeOrShe laughs without mirth then cuts the comm sharply. ",,
dcall_openComms,OpenCommLink,"RepIsAtWorst $faction.id SUSPICIOUS
!$distressTalkedToPlayerBefore
$entity.distressResponse score:1000","$distressTalkedToPlayerBefore = true
$cutCommLinkPolite = true 0
$entity.distressNoHail = true
DistressResponse init
FireBest DCallShowAidOptions","""Must be a relief we showed instead of some pirates, eh?

Now, what was it you needed?""",,
dcall_openCommsRepeat,OpenCommLink,"RepIsAtWorst $faction.id SUSPICIOUS
$entity.distressResponse score:1000","$entity.distressNoHail = true
$cutCommLinkPolite = true 0
DistressResponse init
FireBest DCallShowAidOptionsRepeat","""Need some help after all, do you?""",,
dcall_aidOptions,DCallShowAidOptions,,,,"dcallHelp:""We'll be grateful for anything you can spare.""
dcallMistake:""It was a mistake - we don't actually need help.""
dcallNeverMind:""We didn't issue a distress call.""",
dcall_aidOptionsRepeat,DCallShowAidOptionsRepeat,,,,"dcallHelp:""We'll be grateful for anything you can spare.""
cutCommLinkPolite:Cut the comm link",
dcall_neverMindSel,DialogOptionSelected,$option == dcallNeverMind,"DistressResponse neverMind
FireAll PopulateOptions","""Is that so? Well, I guess we'll hang around here for a bit and wait for who did.""

You get the feeling $heOrShe has some doubts about what you've said.",,
dcall_mistakeSel,DialogOptionSelected,$option == dcallMistake,"DistressResponse neverMind
DistressResponse unrespond
FireAll PopulateOptions","""Well, at least you owned up to it. Still, a distress call is not something to send out lightly.""
OR
$HeOrShe frowns, and says ""Careful, you don't want to earn yourself ... a reputation. It's dangerous out here.""",,
dcall_helpSelNoNeed,DialogOptionSelected,"$option == dcallHelp
!DistressResponse playerNeedsHelp score:1000","DistressResponse didNotNeedHelp
$entity.ignorePlayerCommRequests = true
EndConversation NO_CONTINUE","""But... my scans show you've got plenty enough fuel and supplies. I don't appreciate my time being wasted like this.""

The comm link is cut before you have a chance to respond.",,
dcall_helpSelScam,DialogOptionSelected,"$option == dcallHelp
DistressResponse isCargoPodsScam score:200","DistressResponse cargoPodsScam
$entity.ignorePlayerCommRequests = true
EndConversation NO_CONTINUE","""I can see the cargo pods you've dumped overboard, you know.  I'm not blind. And my sensors indicate the presence of fuel or supplies in those.

I can understand trying to scam a fellow spacer. It's the sheer incompetence of the attempt that's so insulting.""

The comm link is cut before you have a chance to respond.",,
dcall_helpSel,DialogOptionSelected,"$option == dcallHelp
$distressUsesLastCycle <= 2","DistressResponse acceptHelp
FireBest DCallPaymentOptions","""Happy to help a stranded spacer. Do try not to make a habit of getting in trouble, though.""",,
dcall_helpSel1,DialogOptionSelected,"$option == dcallHelp
$distressUsesLastCycle > 2
$distressUsesLastCycle <= 4","DistressResponse acceptHelp
FireBest DCallPaymentOptions","""You're getting a bit of a reputation for getting yourself in trouble, you know. Try to be more careful in the future.""",,
dcall_helpSel2,DialogOptionSelected,"$option == dcallHelp
$distressUsesLastCycle > 4","DistressResponse acceptHelp
FireBest DCallPaymentOptions","""I'll help you for the sake of your crew. One can't help but think you're being dangerously irresponsible, if you keep needing to be bailed out like this.""",,
dcall_helpSel4,DialogOptionSelected,"$option == dcallHelp
$distressUsesLastCycle <= 4
!$distressHelpAdequate score:100","DistressResponse acceptHelp
FireBest DCallPaymentOptions","""Take this - I don't think it's enough, but it's all we have to spare.""",,
dcall_helpSel5,DialogOptionSelected,"$option == dcallHelp
$distressUsesLastCycle > 4
!$distressHelpAdequate score:100","DistressResponse acceptHelp
FireBest DCallPaymentOptions","""What we can spare doesn't look like it'll be enough, but you should be thankful to get anything at all considering the number of times you've had to call for help recently.""",,
dcall_paymentOptions,DCallPaymentOptions,,"AddText ""You have $player.creditsStrC available.""
SetTextHighlights $player.creditsStrC
FireBest DCallPaymentOptionsUpdate",,"0:dcallPay:Offer to pay [$distressPaymentC]
1:dcallThank:Thank $himOrHer profusely, but offer no payment",
dcall_paymentOptionsUpdate,DCallPaymentOptionsUpdate,!$distressCanAfford,"SetEnabled dcallPay false
SetTooltip dcallPay ""Not enough credits to offer to pay a reasonable, non-insulting amount.""",,,
dcall_paySel,DialogOptionSelected,$option == dcallPay,"DistressResponse pay
FireAll PopulateOptions","""Thanks, much appreciated. That'll go a long way to offset our costs.""",,
dcall_thankSel,DialogOptionSelected,$option == dcallThank,"DistressResponse thank
FireAll PopulateOptions","""Yeah, if you could afford to pay your own way, you probably wouldn't be in this situation in the first place, would you?""",,
,,,,,,
,,,,,,
,,,,,,
# tutorial mission,,,,,,
# initial interaction with main contact,,,,,,
tut_mainContactBegin,PickGreeting,"$tut_mainContact score:100
$global.tutStage == INIT",ShowPersonVisual,"Your connection request is accepted surprisingly quickly, given that a $personRank has many responsibilities.

""Ah, you've come - excellent! As you're well aware, recently... well, I suppose we can skip that part.""","0:tutBackground:""I could use a refresher on recent events.""
1:tutCont1:""Yeah, we all know the situation is less than ideal. Now, where do I fit in?""",
tut_mainBackground1,DialogOptionSelected,$option == tutBackground,,"""We've been running experiments on the dormant gate in this system, trying to connect it back to the Domain's gate network.

Promising experiments, or so we thought - until an energy pulse we expected would get a response from the gate destabilized the jump-points leading into the system, cutting us off from the rest of the Sector.

It's rather like how the Sector is cut off from the Domain, writ small- the stars have a sense of irony, do they not?""",0:tutBgCont1:Continue,
tut_mainGetDataInfo1,DialogOptionSelected,$option == tutBgCont1,,"""The miners of Derinkuyu Station, which is also located in this system and was operating near a subsistence level, were hit the hardest. They turned to piracy, intercepting one of the last food shipments to come in - out of desperation, no doubt, but there were deaths, and they've put themselves well outside the law.

Their leaders know that if the jump-points are stabilized and the system is once again part of the Sector, they can look forward to a life sentence at a penal colony at absolute best.""","1:tutCont1:""Alright - now, where do I fit in?""",
tut_mainGetDataInfo2,DialogOptionSelected,$option == tutCont1,,"""The miners-turned-pirate are guarding the jump-points, preventing us from gathering recent readings and coming up with a way to stabilize them.

We do have a security detachment that could handle their forces, but they're tied up defending Ancyra.

The pirates are too much for you to take on, but fortunately you don't have to. We've got an agent on Derinkuyu Station who was able to gain access to recent sensor readings from the ships guarding the jump-points, but they have not been able to get to a long-range comm array to send the data to us.

That's where you come in - head to Derinkuyu and retrieve the data from our agent, then return here.""","0:tutCont2a:""Why me?""
1:tutCont2b:""What's in it for me?""",
tut_mainGetDataWhyMe,DialogOptionSelected,$option == tutCont2a,"AdjustRep $personFaction.id WELCOMING 1
AdjustRepActivePerson WELCOMING 2","""Why not? I'm not exactly spoiled for choice, and you've shown some ability to handle ... difficulties.

It's not going to be a milk run, that's for sure.""","2:tutContGoDark:""What's the plan?""",
tut_mainGetDataWhatsInIt,DialogOptionSelected,$option == tutCont2b,AddRemoveCommodity credits 2000 true,"""Ah, a mercenary. Some credits, naturally, with more along the way - and if all goes to plan, we'll be able to reconnect with the rest of the Sector, such as it is.""","2:tutContGoDark:""What's the plan?""",
tut_mainGetDataGoDark,DialogOptionSelected,$option == tutContGoDark,"SetTextHighlights ""\""Go Dark\""""
AddAbility go_dark 1","""First off, make sure to turn off your transponder once you undock. I've instructed the security detachment not to give you any trouble about that.

If you're lucky, the pirates may even think you're one of their own and let you approach Derinkuyu without any trouble. Still, it makes sense to ""Go Dark"" as you get closer, to make sure they can't get too good a reading on your fleet.""","2:tutContEBurn:""And if they do notice me?""",
tut_mainGetDataEBurn,DialogOptionSelected,$option == tutContEBurn,"SetTextHighlights ""\""Emergency Burn\""""
AddAbility emergency_burn 3","""Then you're in trouble - activate ""Emergency Burn"" to get out of there, lose them, and then come back around to try again.

Don't e-burn unless you really need to, though. It's hard on the ships, and will cost you more supplies to recover from. Eats up a good chunk of fuel, too.""","2:tutCont3:""Very well.""",
tut_mainGetDataAccept,DialogOptionSelected,$option == tutCont3,CallEvent $tut_eventRef startGetData,"""Excellent. Thank you for being willing to help - come back when you've got the data. Good luck!""",0:cutCommLinkPolite:Cut the comm link,
tut_mainComeBackNoStageMatch,PickGreeting,$tut_mainContact score:100,ShowPersonVisual,"Your connection request is accepted quickly.

""Yes? Did you need anything else?""",0:cutCommLinkPolite:Cut the comm link,
,,,,,,
# getting data from agent,,,,,,
tut_dataContactStart,PickGreeting,"$tut_dataContact score:100
$global.tutStage == GO_GET_DATA","ShowPersonVisual
CallEvent $tut_eventRef endGetData",You contact the agent and exchange passphrases to verify each others' identities. The agent then transmits a data file with recent raw sensor readings of the unstable jump-points.,0:cutCommLinkPolite:Cut the comm link,
,,,,,,
# returned to main contact with data,,,,,,
tut_mainContactReturnData,PickGreeting,"$tut_mainContact score:100
$global.tutStage == GOT_DATA","ShowPersonVisual
AddRemoveCommodity credits 5000 true
AdjustRep $personFaction.id WELCOMING 2
AdjustRepActivePerson WELCOMING 4
AddText ""There's a chime in the background, and $heOrShe looks concerned.""","""You have the data! Well done.""

There's a brief wait as you transmit the datafile.

""Now, while the system is running a preliminary analysis of the data - I believe you're due a reward.""","tutGotDataCont1:""Is there a problem?""",
tut_mainContactProbe1,DialogOptionSelected,$option == tutGotDataCont1,,"""Yes - the system estimates it'd take about a cycle to analyze the data and come up with a stabilization algorithm. Naturally, by then, the data would be out of date and any algorithm based on it, meaningless.

If we had an AI core on hand, we could analyze the data more quickly. Fortunately, there's a survey probe somewhere in this system - one left over from the initial exploration of the Sector by the Domain. It should have at least one AI core serving as its brain.""","tutGotDataCont2:""Where is it, and why hasn't it been salvaged before?""",
tut_mainContactProbe2,DialogOptionSelected,$option == tutGotDataCont2,,"""To answer your second question, Domain artifacts are usually protected by automated defenses that still function to this day, and this probe is no exception. And the Hegemony generally forbids civilian interference with Domain artifacts, for the sake of public safety of course.""

""Desperate times, however...""",tutGotDataCont3:Continue,
tut_mainContactProbe3,DialogOptionSelected,$option == tutGotDataCont3,"SetTextHighlights ""\""Active Sensor Burst\""""
AddAbility sensor_burst 2
CallEvent $tut_eventRef goSalvage","""As to where it is, my data indicates it's somewhere beyond the orbit of Pontus - get there, then head out beyond the asteroid belt, and use an ""Active Sensor Burst"". You should at the very least get a sensor contact with the probe.

Head towards it, perform salvage, and bring back an AI core.

If you lack the skill for a full salvage op, just pound it into scrap and scavenge through the resulting debris field - there's a good chance an AI core will survive.""

(""Pontus"" is a gas giant in the outer system. To see its name on the map, you might have to turn off the ""Inhabited"" option in map filter.)","cutCommLinkPolite:""I'll see what I can do.""",
,,,,,,
# returned with AI core,,,,,,
tut_mainContactReturnCore,PickGreeting,"$tut_mainContact score:100
$global.tutStage == GOT_AI_CORE","ShowPersonVisual
AddRemoveCommodity credits 8000 true
AdjustRep $personFaction.id WELCOMING 3
AdjustRepActivePerson WELCOMING 6
AddRemoveCommodity gamma_core -1 true","""Solid work. I'll get my technicians working on this right away. In the meantime, this should cover your expenses, hopefully with a good amount left over.""",tutGotCore1:Continue,
tut_mainContactCore1,DialogOptionSelected,$option == tutGotCore1,,"""I'll send you the stabilization algorithm when the core works it up. Once you have it, it should be a simple matter of running it using your fleet's drive field as a means of interacting with the jump-point.

However, there's still the matter of the miners guarding both jump-points out of the system.""","tutGotCore2:""And you've said their forces are significant?""",
tut_mainContactCore2,DialogOptionSelected,$option == tutGotCore2,,"""Well, it's all relative. Our security detachment could handle them easily, but as I've mentioned, it's tied down defending Ancyra.

Your fleet, on the other hand... you might be able to handle them with some stellar piloting and a bit of luck, but it's best not to take such chances.

Especially not when there's an alternative.""","tutGotCore3:""What alternative is that?""",
tut_mainContactCore3,DialogOptionSelected,$option == tutGotCore3,CallEvent $tut_eventRef goRecover,"""There's a ship graveyard around Tetra. Ships that were deemed not worth the effort to restore, awaiting bulk transit to one of the ship-breaking facilities elsewhere.

Now, though, they'll serve our needs. Go there and recover all the ships you can - and break the ones you can't for supplies. Make sure to bring enough crew to operate the recovered ships - perhaps an extra hundred or so will do.

You'll need to transport them somehow, too - here, take this Mudskipper transport; consider it part of your reward.""","cutCommLinkPolite:""Thank you. I'll return with the ships.""",
,,,,,,
# back after recovering ships,,,,,,
tut_mainContactReturnShips,PickGreeting,"$tut_mainContact score:100
$global.tutStage == RECOVERED_SHIPS","ShowPersonVisual
RepairAll false","""Welcome back!

A bunch of rust buckets, aren't they? But put some weapons on them, get a proper refit done, and with a dedicated crew, they'll do alright. It's no worse than what the pirates have got, at any rate.","tutGotShips1:""Speaking of weapons...""",
tut_mainContactReturnShips1,DialogOptionSelected,$option == tutGotShips1,CallEvent $tut_eventRef printRefitHint,"""Yeah, was just about to talk to you about that. Not much to buy on the open market, but we have some stores.

I've already ordered local storage space to be assigned to you, and some suitable weapons transferred there - along with enough supplies to speedily bring the new ships back to full combat readiness.

Use them to outfit your new ships, make sure you've got enough crew for a full complement on every ship, and then break the rogue miner defenses at the inner jump-point!","tutGotShips2:""I take it you've got the stabilization algorithm, then?""",
tut_mainContactReturnShips2,DialogOptionSelected,$option == tutGotShips2,,"""Correct! These cores seem like they can work miracles sometimes. Let me transmit the results.

Good luck to you! If you fail... well, we'll have to send the security force to do the job, and then it could get very messy.""","tutGotShips3:""It's good to know you're already working on a Plan B.""",
tut_mainContactReturnShips3,DialogOptionSelected,$option == tutGotShips3,CallEvent $tut_eventRef goStabilize,"""Come now, it's not so grim - I have every expectation you'll succeed, or I wouldn't send you. But it's my responsibility as commander to plan for every eventuality, and not rely on a miraculous savior.

Now, about those miners - the two fleets guarding the jump-point will aid each other if you engage one when the other is nearby, so it'll be an easier fight if you manage to separate them first. If you can't, it should still be a fight you can win, though.""","cutCommLinkPolite:""Copy that. I'll be back here when the job's done.""",
,,,,,,
# stabilized jump-point and returned to Ancyra,,,,,,
tut_mainContactStabilized,PickGreeting,"$tut_mainContact score:100
$global.tutStage == STABILIZED","ShowPersonVisual
AddRemoveCommodity credits 10000 true
AdjustRep $personFaction.id WELCOMING 5
AdjustRepActivePerson WELCOMING 10
CallEvent $tut_eventRef pickJangalaContact","""Well done!""

$PersonPost $personLastName seems a bit giddy with excitement.

""We actually did it! You just never know with these things, it's such a relief not to be cooped up in this system anymore.

Here's your reward, well earned and with my gratitude.""",tutStabilized1:Continue,
tut_mainContactStabilized1,DialogOptionSelected,$option == tutStabilized1,"SetTextHighlights $jangalaFuel
CallEvent $tut_eventRef deliverReport","""Now, I expect the authorities at the headquarters on Jangala, in the Corvus system, would like to hear about the recent events. Would you deliver a report for me?

Ask to speak with $jangalaContactPost $jangalaContactLastName when you get there.

Oh, and make sure to take enough fuel to make the trip; flying in-system as you have been doesn't use fuel, so it's easy to forget that flying in hyperspace does. It's not too far, but with your current fleet you'll need at least $jangalaFuel units to get there.""",tutStabilized2:Continue,
tut_mainContactStabilized2,DialogOptionSelected,$option == tutStabilized2,"SetTextHighlights ""\""Distress Call\""""
AddAbility distress_call 9","""If you do manage to run out of fuel somehow, and get stuck in an uninhabited system - and that'd be a real feat on the Galatia-Corvus route, let me tell you - you can always issue a ""Distress Call"" and wait for help to arrive.""",tutStabilized3:Continue,
tut_mainContactStabilized3,DialogOptionSelected,$option == tutStabilized3,,"""I'm also declaring a bounty on the remaining rogue miner fleets here. If you like, you can stick around here and help mop up before going to Corvus.""","cutCommLinkPolite:""Ok, I'll consider my options.""",
,,,,,,
,,,,,,
# delivering report to Jangala,,,,,,
tut_janContactReport,PickGreeting,"$tut_jangalaContact score:100
$global.tutStage == DELIVER_REPORT","ShowPersonVisual
AdjustRep $personFaction.id WELCOMING 5
AdjustRepActivePerson WELCOMING 10
CallEvent $tut_eventRef reportDelivered","Your connection request is accepted after a slight delay.

""Yes, and you are? Ah, you have a report for me, let's just take a look.

Galatia is back on the map? That's excellent news. Says here you've had quite a hand in it, too. That won't be forgotten.""","tutReport1:""What do I do now?""",
tut_janContactReport1,DialogOptionSelected,$option == tutReport1,,"""I don't have anything specific for you right now, but you've got options.

There's a bounty in this system right now due to unusually high pirate activity. You've already got some experience dealing with pirates, so that could be a good way to earn some credits.""",tutReport2:Continue,
tut_janContactReport2,DialogOptionSelected,$option == tutReport2,,"""You could also try your hand at salvaging - load up on fuel, machinery, and supplies, and head for the outer systems. 

It's a good idea to pick up a mission first, so you're not running blind - someone's usually offering good money to analyze this planet or that derelict, and where there's one, there's often more.""",tutReport3:Continue,
tut_janContactReport3,DialogOptionSelected,$option == tutReport3,,"""Finally, you could take a comission with the Hegemony - due to the Galatia business, your standing is high enough that such a request would be accepted.

You'll be expected to fight our enemies, though, so it's quite a commitment. If I were you, I'd hold off on it until you've got a more solid fleet behind you.""","cutCommLinkPolite:""Thanks, I'll think about it.""",